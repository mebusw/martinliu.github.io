<!DOCTYPE html>
<html class="no-js">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Martin's Blog | MDTM：淺談FTP協定如何保留下載檔案的日期 / 時間</title>
    <meta name="description" content="應該有很多朋友知道，用 FTP 下載檔案的時候，可以設定「保留下載檔案的日期 / 時間」。例如如果妳用的 FTP client 是 FileZilla 這個跨平台的自由軟體（以 2.2.32 版為例）：編輯 &gt; 設定 &gt; 檔案傳輸設定 &gt; 保留下載檔案的日期 / 時間Edit &gt; Sett...">

    <link rel="stylesheet" href="/css/main.css">

    <link rel="canonical" href="http://localhost:4000/2008/07/15/mdtm-ef-bc-9a-e6-b7-ba-e8-ab-87ftp-e5-8d-94-e5-ae-9a-e5-a6-82-e4-bd-95-e4-bf-9d-e7-95-99-e4-b8-8b-e8-bc-89-e6-aa-94-e6-a1-88-e7-9a-84-e6-97-a5-e6-9c-9f-e6-99-82-e9-96-93/">
    <link rel="alternate" type="application/rss+xml" title="Martin's Blog" href="http://localhost:4000/feed.xml" />

    <!--[if lt IE 9]>
        <script src="/js/vendor/html5shiv.min.js"></script>
    <![endif]-->
</head>


  <body class="">
    <!-- if the user has javascript disabled they can still use the menu -->
<noscript>
    <div class="no-js-menu clearfix">
        <ul>
            
                <li><i class="fa fa-home"></i><a href="/">Home</a></li>
            
                <li><i class="fa fa-home"></i><a href="/home-alt">Home Alt</a></li>
            
                <li><i class="fa fa-home"></i><a href="/home-alt-2/">Home Alt 2</a></li>
            
                <li><i class="fa fa-anchor"></i><a href="/about">About</a></li>
            
                <li><i class="fa fa-plane"></i><a href="/contact">Contact</a></li>
            
                <li><i class="fa fa-user"></i><a href="/author/michelle">Author</a></li>
            
        </ul>
    </div>
</noscript>
<!-- end no script -->

    <header class="hero-image" style="background-image: url(/img/.jpg);">
    <span class="menu-trigger animated fadeInDown">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
    </span>

    <div id="menu-target">
    <ul>
        
            <li><i class="fa fa-home"></i><a href="/">Home</a></li>
        
            <li><i class="fa fa-home"></i><a href="/home-alt">Home Alt</a></li>
        
            <li><i class="fa fa-home"></i><a href="/home-alt-2/">Home Alt 2</a></li>
        
            <li><i class="fa fa-anchor"></i><a href="/about">About</a></li>
        
            <li><i class="fa fa-plane"></i><a href="/contact">Contact</a></li>
        
            <li><i class="fa fa-user"></i><a href="/author/michelle">Author</a></li>
        
    </ul>
</div>

</header>

<main class="container">
    <div class="row">
        <div class="col-xs-12 single-content">
            <p class="meta">
                <a href=""></a> in <a href='/category/Blog'>Blog</a> <i class="link-spacer"></i> <i class="fa fa-bookmark"></i>  minutes
            </p>

            <h1>MDTM：淺談FTP協定如何保留下載檔案的日期 / 時間</h1>

            <p>應該有很多朋友知道，用 FTP 下載檔案的時候，可以設定「保留下載檔案的日期 / 時間」。例如如果妳用的 FTP client 是 <a href="http://filezilla-project.org/">FileZilla</a> 這個跨平台的自由軟體（以 2.2.32 版為例）：<br /><br />編輯 &gt; 設定 &gt; 檔案傳輸設定 &gt; 保留下載檔案的日期 / 時間<br />Edit &gt; Settings &gt; File transfer settings &gt; Preserve date/time of downloaded files<br /><br />設定是很簡單，其他的 FTP client 軟體也都有這個設定，一般人知道怎麼設定（自己用的 FTP 軟體）也就夠了。<br /><br />但是，原理是什麼呢？<br /><br />我用 ftp preserve date/time of downloaded files 去 Google 撈過來撈過去……<br /><br />原來，這是取決於伺服器端的，如果妳連上的 FTP server 有支援 MDTM 這個功能，那妳只要在 FTP client 端設定一下，就可以保留下載檔案的日期 / 時間囉。<br /><br />嗯，既然是通訊協定，一定在某一份 <a href="http://zh.wikipedia.org/w/index.php?title=RFC&amp;variant=zh-tw">RFC</a> 裡面有定義才是，這次改用 rfc ftp mdtm 撈，就撈到 <a href="http://tools.ietf.org/html/rfc3659">RFC 3659</a> ，其中就有 File Modification Time (MDTM) 的定義<br /><br />要怎麼知道妳連上的 FTP 伺服器有支援這個功能呢？很簡單，只要下 FEAT 指令，看看有沒有這個 FEATure 。底下是我用 MS Windows XP 的 command prompt ，連上某個 ftp 站之後，下指令的結果：<br /><br />ftp&gt; <strong>quote FEAT</strong><br />211-Features:<br />EPRT<br />EPSV<br />MDTM<br />PASV<br />REST STREAM<br />SIZE<br />TVFS<br />211 End<br />ftp&gt; <strong>quote SYST</strong><br />215 UNIX Type: L8<br />ftp&gt; <strong>quote HELP</strong><br />214-The following commands are recognized.<br />ABOR ACCT ALLO APPE CDUP CWD  DELE EPRT EPSV FEAT HELP LIST MDTM MKD<br />MODE NLST NOOP OPTS PASS PASV PORT PWD  QUIT REIN REST RETR RMD  RNFR<br />RNTO SITE SIZE SMNT STAT STOR STOU STRU SYST TYPE USER XCUP XCWD XMKD<br />XPWD XRMD<br />214 Help OK.<br />ftp&gt; <strong>quote MDTM welcome.msg</strong><br />213 20080613045501<br />ftp&gt;<br /><br /><br />嗯，所以我們可以這樣取得 welcome.msg 這個檔案的時間戳記 (timestamp) 。不過，微軟提供的 ftp.exe 比較陽春，並沒有內建保留下載檔案的日期 / 時間這樣的功能，所以妳可以考慮使用 <a href="http://filezilla-project.org/">FileZilla</a> 。如果一定要在命令列模式實現這樣的功能，可以考慮<a href="http://www.ncftp.com/download/">下載 NcFTP</a> 的 MS Windows 版本，或者寫個 script 來控制 ftp.exe 。<br /><br />==<br />喔，如果是 <a href="http://filezilla-project.org/">FileZilla</a> 3.X 的話，這個設定放在：<br />傳輸 &gt; 保留傳輸檔案的時間戳記<br />Transfer &gt; Preserve timestamps of transferred files<br /><br />======<br />有沒有發現，我們一直都在談「下載檔案」，那，用 FTP <strong>上傳</strong>檔案，能不能保留檔案的日期 / 時間呢？有一些軟體拿 MDTM 來做這個功能，其實是不符合 RFC 3659的。比較正式的規範，目前應該是要用 MFMT 來做：<br /><br />目前有份 <a href="http://tools.ietf.org/html/draft-somers-ftp-mfxx-03">IETF draft 提到</a> MFMT (Modify Fact: Modification Time)， FileZilla FTP server 0.9.25 有支援這個功能，如果妳用的 FTP client 也有這個功能，就可以實現「保留上傳檔案的日期 / 時間」<br /><br />FileZilla 團隊有整理了 <a href="http://wiki.filezilla-project.org/File_Transfer_Protocol">File Transfer Protocol</a> 相關的文件。<br /><br />==<br />為了答謝一直看到這裡的朋友，低調的提一下 <a href="http://www.devpro.it/filezilla_pr/">Filezilla Password Recover</a> :p<br /><br />（本文原載於 <a href="http://blog.roodo.com/ystuan/archives/6171547.html">http://blog.roodo.com/ystuan/archives/6171547.html</a>）</p>


        </div><!-- main-content/col -->
    </div> <!--/row -->

</main> <!-- /container -->

<footer class="single">
    <div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-2">
            <img src="/img/.jpg" class="user-icon " alt="user-image">
        </div>
        <div class="col-xs-12 col-sm-6">
            <div class="category-list">
                <p>Published <span>Jul 15, 2008</span></p>
                <p><a href=""></a> in <a href='/category/Blog'>Blog</a></p>

                <div class="other-catergories">
                    <h3>Also found in</h3>

                    <ul>
                        
                        <li>
                            <a href='/category/Blog'>Blog</a>
                            
                        </li>
                        
                    </ul>
                </div>

            </div>
        </div><!-- end col -->
        <div class="col-xs-12 col-sm-4">
            <div class="social">
                <p>Share this article</a>
                <div class="social-links">
                    <a class="social-icon" href="#" data-platform="twitter" data-message="" data-url="http://localhost:4000/2008/07/15/mdtm-ef-bc-9a-e6-b7-ba-e8-ab-87ftp-e5-8d-94-e5-ae-9a-e5-a6-82-e4-bd-95-e4-bf-9d-e7-95-99-e4-b8-8b-e8-bc-89-e6-aa-94-e6-a1-88-e7-9a-84-e6-97-a5-e6-9c-9f-e6-99-82-e9-96-93/"><i class="fa fa-twitter"></i></a>

                    <a class="social-icon" href="#" data-platform="facebook" data-message="" data-url="http://localhost:4000/2008/07/15/mdtm-ef-bc-9a-e6-b7-ba-e8-ab-87ftp-e5-8d-94-e5-ae-9a-e5-a6-82-e4-bd-95-e4-bf-9d-e7-95-99-e4-b8-8b-e8-bc-89-e6-aa-94-e6-a1-88-e7-9a-84-e6-97-a5-e6-9c-9f-e6-99-82-e9-96-93/"><i class="fa fa-facebook-official"></i></a>
                    <a class="social-icon" data-platform="mail"  href="mailto:67120666@qq.com?body=http://localhost:4000/2008/07/15/mdtm-ef-bc-9a-e6-b7-ba-e8-ab-87ftp-e5-8d-94-e5-ae-9a-e5-a6-82-e4-bd-95-e4-bf-9d-e7-95-99-e4-b8-8b-e8-bc-89-e6-aa-94-e6-a1-88-e7-9a-84-e6-97-a5-e6-9c-9f-e6-99-82-e9-96-93/"><i class="fa fa-envelope"></i></a>
                </div>
            </div>
        </div>
    </div><!-- end row -->
</div>


    
</footer>


    <script src='/js/vendor/modernizr.custom.32229-2.8-respondjs-1-4-2.js'></script>
    <script src="/js/vendor/jquery-1.11.2.min.js"></script>
    <script src='/js/vendor/jquery.jpanelmenu.min.js'></script>
    <script type='application/javascript' src='/js/vendor/fastclick.min.js'></script>
    
    <script src=' /js/main.js'></script>
  </body>

</html>
