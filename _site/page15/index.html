<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Latest Posts &#8211; Martin's Blog</title>
<meta name="description" content="DevOps Coach & Cloud Expert">
<meta name="keywords" content="DevOps, Cloud, AWS, HCI, Nutanix, ITSM">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://martinliu.cn/images/path.jpg">

<meta name="twitter:title" content="Latest Posts">
<meta name="twitter:description" content="DevOps Coach & Cloud Expert">
<meta name="twitter:creator" content="@zliu">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Latest Posts">
<meta property="og:description" content="DevOps Coach & Cloud Expert">
<meta property="og:url" content="http://martinliu.cn/page15/">
<meta property="og:site_name" content="Martin's Blog">

<meta name="google-site-verification" content="4oSwNTpy1vzip3_lt6XhkhMfImCD_DZlvL3K1k-M8qk">



<link rel="canonical" href="http://martinliu.cn/page15/">
<link href="http://martinliu.cn/feed.xml" type="application/atom+xml" rel="alternate" title="Martin's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://martinliu.cn/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://martinliu.cn/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://martinliu.cn/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://martinliu.cn/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://martinliu.cn/images/apple-touch-icon.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://martinliu.cn/images/apple-touch-icon-72x72.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://martinliu.cn/images/apple-touch-icon-114x114.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://martinliu.cn/images/apple-touch-icon-144x144.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://martinliu.cn/">首页</a></li>
		<li>
			<a href="#">关于</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://martinliu.cn/images/avatar.jpg" alt="Martin Liu photo" class="author-photo">
					<h4>Martin Liu</h4>
					<p>DevOps Coach, Cloud Expert, Runner</p>
				</li>
				<li><a href="http://martinliu.cn/about/"><span class="btn btn-inverse">详情</span></a></li>
				<li>
					<a href="mailto:67120666@qq.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/zliu"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				
				<li>
					<a href="https://google.com/+MartinLiu-cn"><i class="fa fa-fw fa-google-plus"></i> Google+</a>
				</li>
				<li>
					<a href="https://linkedin.com/in/liuzheng"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="https://github.com/martinliu"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">文章</a>
			<ul class="dl-submenu">
				<li><a href="http://martinliu.cn/posts/">所有文章</a></li>
				<li><a href="http://martinliu.cn/tags/">所有分类</a></li>
			</ul>
		</li>
		
	    
	    <li><a href="http://www.aws-faq.com" target="_blank">AWS-FAQ</a></li>
	  
	    
	    <li><a href="http://devopscoach.org" target="_blank">DevOps教练</a></li>
	  
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  
  
    <div class="entry-image">
      <img src="http://martinliu.cn/images/path.jpg" alt="Latest Posts">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Martin's Blog</h1>
      <h2>Latest Posts</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-01-25T18:10:09+08:00"><a href="http://martinliu.cn/2015/01/25/e5-86-8d-e6-ac-a1-e5-85-a5-e6-89-8blinux-fedora-21/">January 25, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://martinliu.cn/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://martinliu.cn/2015/01/25/e5-86-8d-e6-ac-a1-e5-85-a5-e6-89-8blinux-fedora-21/" rel="bookmark" title="再次入手Linux - Fedora 21" itemprop="url">再次入手Linux - Fedora 21</a></h1>
    
  </header>
  <div class="entry-content">
    <p>再次安装桌面版的Linux操作系统 ，并打算作为主要的工作平台。已经是 fedora 21，需要新贴纸了。</p>

<p>接下来作的：http://www.linuxidc.com/Linux/2015-01/111481.htm</p>

<p>剩余没做的是按照搜狗输入法。</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-01-21T23:46:31+08:00"><a href="http://martinliu.cn/2015/01/21/e8-99-9a-e6-8b-9f-e6-9c-ba-e6-a0-b9-e5-88-86-e5-8c-ba-e6-89-a9-e5-ae-b9/">January 21, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://martinliu.cn/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://martinliu.cn/2015/01/21/e8-99-9a-e6-8b-9f-e6-9c-ba-e6-a0-b9-e5-88-86-e5-8c-ba-e6-89-a9-e5-ae-b9/" rel="bookmark" title="虚拟机根分区扩容" itemprop="url">虚拟机根分区扩容</a></h1>
    
  </header>
  <div class="entry-content">
    <p>我的Satellite虚拟机下载了所有常用的repo，100GB的磁盘空间都占满了，无奈必须扩容，否则没法用了。</p>

<p>扩容的前提条件正好满足：根分区在最后一个分区。</p>

<p>由于是kvm的虚拟机，所以首先需要扩大硬盘文件的大小： qemu-img resize my.img +100G 。</p>

<p>下面去操作系统里扩容。先要用fdisk删除根分区。记录初始的其实点。然后用n命令新建分区，输入原始其实点位置，回车默认接受结束点的最后一个位置。w存盘。</p>

<p>reboot系统，起来之后用命令扩容分区： resize2fs /dev/vda2 ； 在线扩容需要等一段时间，100GB的空间初始化在我的普通磁盘上做了5分钟左右。在此reboot机器，起来之后在看 df -kh 发现已经增加了100GB了，接下来再也不用担心类似情况了。</p>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-01-11T00:42:29+08:00"><a href="http://martinliu.cn/2015/01/11/rhel-e6-80-a7-e8-83-bd-e6-8f-90-e5-8d-87-e6-96-b9-e6-b3-95-e5-92-8c-e5-b7-a5-e5-85-b7/">January 11, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://martinliu.cn/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://martinliu.cn/2015/01/11/rhel-e6-80-a7-e8-83-bd-e6-8f-90-e5-8d-87-e6-96-b9-e6-b3-95-e5-92-8c-e5-b7-a5-e5-85-b7/" rel="bookmark" title="RHEL 性能 提升方法和工具" itemprop="url">RHEL 性能 提升方法和工具</a></h1>
    
  </header>
  <div class="entry-content">
    <p>RHEL 7 中已经引入了比较完备的性能优化、调整和监控的工具。对于我这个监控背景的人来说，不具体看下，实在忍不住。</p>

<p>首先，从这篇KB学起来把。<a href="https://access.redhat.com/articles/785283"> https://access.redhat.com/articles/785283</a></p>

<p>RHEL 下性能调优的工具有三种。</p>

<ul>
  <li>
    <p>Performance Co-Pilot</p>
  </li>
  <li>
    <p>TUNA</p>
  </li>
  <li>
    <p>Tuned</p>
  </li>
</ul>

<p>下面依次简单说下这几个工具。</p>

<h1 id="performance-co-pilot-"> Performance Co-Pilot 监控工具</h1>

<p>[caption id=”attachment_53397” align=”alignnone” width=”1000”]<a href="http://cdn1.martinliu.cn/wp-content/uploads/2015/01/Screenshot-from-2015-01-11-000449.png"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/01/Screenshot-from-2015-01-11-000449-1000x630.png" alt="PCP Charts - Overview View" /></a> PCP Charts - Overview View[/caption]</p>

<p>PCP是一个工具集，它分为两个部分：</p>

<ul>
  <li>
    <p>PCP Collectors ： 性能指标数据采集器，它可以从系统内核或者其他数据源来持续的采集数据。是由几个系统服务组成。 These are the parts of PCP that collect and extract performance data from various sources, e.g. the operating system kernel.</p>
  </li>
  <li>
    <p>PCP Monitors ：性能参数集中查看和监控的图形界面。它可以同时连接多台服务器。These  are the parts of PCP that display data collected from hosts (or archives) that have the PCP Collector installed.  Many monitor tools are available as part of the core PCP release, whileother (typically graphical) monitoring tools are available separately in the  PCP  GUI package.</p>
  </li>
</ul>

<p>极简实施测试方法：</p>

<p>1) 安装pcp的相关软件包（在需要被监控的机器上安装pcp即可，在需要使用图形界面查看的机器上安装pcp-gui）</p>

<p>$ yum install pcp pcp-gui</p>

<p>2) 启用数据收集器的服务（在需要被监控的机器上运行这些服务，在监控的周期完成之后，可以考虑关闭这些服务）</p>

<p>$ chkconfig pmcd on; service pmcd start
$ chkconfig pmie on; service pmie start
$ chkconfig pmlogger on; service pmlogger start</p>

<p>3) 查看监控到的图形：</p>

<ol>
  <li>
    <p>在pcp-gui主机的host文件中加入被监控主机的地址解析</p>
  </li>
  <li>
    <p>在RHEL 7 桌面的程序中，找到并运行 PCP Charts程序</p>
  </li>
  <li>
    <p>它默认就是连接到本机，因此加入我们需要查看的性能参数图形即可。点击open view ，选择overview 视图即可。当然，它内置的监控视图还有很多，当然如果你希望，还可以把远程的服务器性能实时状态（点击新建视图）视图也加入进来。其它视图如下图所示。</p>
  </li>
</ol>

<p>[caption id=”attachment_53396” align=”alignnone” width=”520”]<a href="http://cdn1.martinliu.cn/wp-content/uploads/2015/01/Screenshot-from-2015-01-11-000611.png"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/01/Screenshot-from-2015-01-11-000611-520x306.png" alt="内置视图" /></a> 内置监控视图[/caption]</p>

<p>更多信息求助  man PCPIntro documentation.</p>

<p>主要适用场景：</p>

<ul>
  <li>
    <p>在RHEL下作应用或者操作系统的性能测试或调优，如果不需要或者没有必要使用第三方工具的话，它应该是首选。</p>
  </li>
  <li>
    <p>对生产系统性能做瓶颈定位，用它可以收集和追踪系统一段时间（一天、一周、一个月）的各种性能参数的表现情况，收集下来的数据可以作单点的或者横向的分析。它能够收集的参数还是相当全面的。</p>
  </li>
</ul>

<p>PCP的目的是了解系统的实时的性能状态，为性能调优找到方向和目标。也可以作为日常性能监控的工具之一，为性能派错提供一臂之力。</p>

<h1 id="tuna">TUNA</h1>

<p>TUNA 则适合于复杂性能参数的调整，能对很多kernel和网络的性能参数在图形界面中配置，对于一次性要修改n个文件的深度复杂性能调优，它可以是一个提高工作效率的利器。而且，如果是某种性能参模版，可以用它作配置的导入导出。这一便于工程师，面对一对类似系统做重复的手工劳动。</p>

<p>[gallery size=”mobile” link=”file” ids=”53398,53399,53400”]</p>

<p>极简实施测试方法：</p>

<p>1) Install the necessary packages:
$ yum install tuna</p>

<p>2) Start the tuning application
$ tuna</p>

<p>For more information, please see the man tuna documentation</p>

<p>主要适用场景：</p>

<ol>
  <li>
    <p>高效深度调优</p>
  </li>
  <li>
    <p>工作在范围比较大的性能参数上</p>
  </li>
  <li>
    <p>需要保存并且一致地实施这些参数配置到其它机器上</p>
  </li>
  <li>
    <p>希望使用图形界面操作</p>
  </li>
</ol>

<h1 id="tuned">TUNED</h1>

<p>写了一堆文字了，现在我才开始我需要作的正事。我的需求是：优化一台物理的测试机的性能。我希望用最少的时间，直接让系统进入针对kvm虚拟机性能优化的基础优化状态（性能优化基线）。目前我还没有时间关心所有的性能参数细节，我只想快速完成这件事。方法如下：</p>

<p>1) 安装tuned
$ yum install tuned</p>

<p>2) 使用 tuned-adm 选择并加载
$ tuned-adm list
Available profiles:
- balanced
- desktop
- latency-performance
- powersave
- sap
- throughput-performance
- virtual-guest
- virtual-host
Current active profile: balanced</p>

<p>tuned-adm profile  virtual-host      // 最重要的就是这个命令，让操作系统优化成虚拟机host服务器的性能优化调整基线</p>

<p>上面这条命令其实就是我写本文的目的。打完这条命令，我可以洗洗睡了。如果你还睡不着，可以看下下面这个文章。</p>

<p><a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/7-Beta/html-single/Performance_Tuning_Guide/#_tuned_adm">Red Hat Enterprise Linux 7.0 - Performance Tuning Guide - 3.7. tuned-adm</a></p>

<h1 id="section"> 性能 提升方法</h1>

<p>性能调优有几个方面需要考量。工具方面，需要选择一个合适的工具集，需要这个工具集能够统一的覆盖所有需要管理和调优的操作系统类型和版本；目的在于能够得到所有系统的基于统一工具的性能快照（当前的状态基线）；流程方面，需要建立性能调优和持续性能改进的流程。它应该和ITIL里的可用性管理和容量管理关联起来。性能提升的流程应该有一下几个活动：</p>

<ol>
  <li>
    <p>目标选择：选择当前环境性能基线快照目标的对象服务器，选择尽可能要典型、全面、量要够。针对采样对象，作统一的性能参数收集，选择必选和候选的性能参数指标。指标要选的有目的和有特点。目标采样对象可能会慢慢的扩大到更多的对象。目标采集的性能参数也需要，每次都review，可以作有必要的调整。</p>
  </li>
  <li>
    <p>性能参数收集：最好在相同的时间段内收集一定时长的性能参数。建议使用一种统一的工具，这样可以更好第做横向对比。实在不行，可以对同一种操作系统使用一种工具。当然采集工具的数量越少越好，越多工作量越大，分析报表的成本越高。这个阶段RHEL上可以使用PCP。</p>
  </li>
  <li>
    <p>建立性能调优目标：每一种业务应用或者某一类系统的基本性能诉求可能是一致的，把收集回来的数据，做分析整理和加工，对比历史的、业内标准的或者同行业的参考数据。得出本次性能参数调整的目标参数集。不同类型的系统，目标调整的参数集应该是不同的。</p>
  </li>
  <li>
    <p>实施性能优化参数：手工的或者用自动化工具来在目标系统中实时系统参数调整。当然，建议提前做测试，保证不会影响业务正常运行，也可以使用分批分拨实施的方法。建议的方法如下，a)使用自动化配置管理工具，如puppet或类似方案，把参数调整模版用puppet 的模块来表达，并持续改进，发布最新的版本到目标host group上去即可。b）使用手工的方式实施，这里可用用到tuna工具。</p>
  </li>
  <li>
    <p>调优结果分析：再次收集一个周期的性能数据。对比这些数据和第二步骤中的数据。分析和记录本次调优的成败和总结。找出提升的部分，无提升的步骤。为下次调优做些后续的注意事项。</p>
  </li>
</ol>

<p>以上活动应该在IT Service mnager的负责下定期执行。目标就是提升系统性能和效率，确保每个业务都能运行在最高的性能，为系统的容量管理和性能管理给出可靠的参考数据。</p>

<p>最后，tuned并没有写在上面的流程中，并不是说它没有到。它其实应该被用在每个操作系统实例安装和初始化的阶段。它提供的是红帽为RHEL推荐的最基础的性能调优参数建议，是性能调优基线的基线。实施方法很简单，在系统初始化的post action中加入这个条目，针对不同类型的系统激活一个合适的profile即可。</p>

<p>性能 提升不是一蹴而就的，而是一个长期的过程。可以使用PDAC的思想，扎实的走好以上建议流程。使用自动化运维工具和必要的数据分析工具加速以上流程。</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-01-06T23:55:02+08:00"><a href="http://martinliu.cn/2015/01/06/kvm-virt-manager-e5-ae-9e-e7-94-a8-e5-8f-82-e8-80-83-e6-89-8b-e5-86-8c/">January 06, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://martinliu.cn/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://martinliu.cn/2015/01/06/kvm-virt-manager-e5-ae-9e-e7-94-a8-e5-8f-82-e8-80-83-e6-89-8b-e5-86-8c/" rel="bookmark" title="KVM Virt-Manager  实用参考手册" itemprop="url">KVM Virt-Manager  实用参考手册</a></h1>
    
  </header>
  <div class="entry-content">
    <h1 id="virt-manager">关于 virt manager</h1>

<p>Virt Manager 是一个不错的kvm虚拟机管理工具，能够方便地管理虚拟机。我的测试机目前已经完全转向RHEL7上跑KVM虚拟机，通过virt-manager去管理的方案。</p>

<p><a href="http://cdn1.martinliu.cn/wp-content/uploads/2015/01/topbar_logo.png"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/01/topbar_logo.png" alt="topbar_logo" /></a></p>

<p>安装virt-manager：yum install -y virt-* ； 装完之后重新启动机器即可使用。</p>

<h1 id="section">建议初始配置</h1>

<p>安装完后有几个环境的配置推荐可以做一下。</p>

<p><img src="http://martinliu.cn/wp-content/gallery/virt-manager-kvm-1/Screenshot-from-2015-01-06-193413.png" alt="点击New Volume" /></p>

<p>Storage Pool ： 一个默认的 + 两个自建的</p>

<ul>
  <li>
    <p>Default ：这是virt-manager安装时默认创建的，它和操作系统在同一个卷上，我的测试机使用SSD卷，因此我所有虚拟机都会使用这个卷，这样速度比较快</p>
  </li>
  <li>
    <p>hd ：这是测试机上普通磁盘的一个目录，目的是把那些不需要快速IO的虚拟机跑着这里，节省SSD的磁盘空间</p>
  </li>
  <li>
    <p>iso ：这是普通磁盘上的iso文件目录，单独挂在这是为了，使用方便</p>
  </li>
</ul>

<p><img src="http://martinliu.cn/wp-content/gallery/virt-manager-kvm-1/Screenshot-from-2015-01-06-210927.png" alt="自建的内外1" /></p>

<p>虚拟网络 （一个默认+两个新建）</p>

<ul>
  <li>
    <p>default ： 这个是安装了virt-manager + kvm 之后就有的，是用NAT的方式，带dhcp，默认虚拟机可以连接物理机所在的外围</p>
  </li>
  <li>
    <p>virbr1/virbr2 ：是我根据自己的需要建立的，只能和host物理机通讯，无dhcp</p>
  </li>
</ul>

<p>我最近做OpenStack的实践，OpenStack需要最好隔离的几个网络跑不同的数据，因此virbr1/2正好符合OpenStack的测试需求。另外我在物理机的操作系统上搭建了yum源服务器，因此任何一个虚拟机都可以通过http访问我放在物理机上的repo目录，我只需要更新这些repos目录里面的rpm包的内容，我的lab环境中的所有虚拟机（不管是在何网络）都可以使用到最新的系统更新包和软件包了。这样大大提高了虚拟机里面软件测试的效率，所有虚拟机像是在本地安装rpm软件包一样，再也不需要联网下载，我只需要每周去公司联网同步一下这些目录即可。</p>

<p>有了以上配置之后，就可以高效工作了，效率感觉比vmware workstation要高，速度快稳定。下面是虚拟机创建的流程，里面有些我的推荐做法。</p>

<p><img src="http://martinliu.cn/nextgen-attach_to_post/preview/id--53382" alt="" /></p>

<p>本想看下，virt-install 的使用方式，感觉那个参数太多，容易敲错，还是界面比较容易上手，而且出错的机会不高。</p>

<h1 id="section-1">命令行常用操作指南（持续更新中）</h1>

<p>virt-manager主要操作还是在命令行比较高效，特别是下面的这些操作，在使用过程中，比较多用，用的多了感觉比GUI操作方式效率高多了。</p>

<p>virt-manager的命令行功能调用有两种方式：</p>

<ul>
  <li>
    <p>直接 virsh 回车 ，之后就进入了 virsh # 的一个专门的shell，help 就能看的里面支持的所有命令</p>
  </li>
  <li>
    <p>在普通shell下 直接 virsh <操作命令> <参数>，</参数></操作命令></p>
  </li>
</ul>

<p>这两个方式的调用没有差异，感觉全凭个人的操作习惯。</p>

<p>下面是一些常用的虚拟机管理功能命令参数和实例。</p>

<p>开启一个虚拟机</p>

<p>virsh # start server8-a</p>

<p>查看所有虚拟机(on and off)</p>

<p>virsh list –all</p>

<p>关闭一个虚拟机</p>

<p>virsh # shutdown server8-a</p>

<p>对一个虚拟机作一个快照</p>

<p>snapshot-create-as server8-a flat-os “before customization”</p>

<p>查看虚拟的所有快照</p>

<p>snapshot-list server8-a</p>

<p>返回到之前的一个snapshot</p>

<p>virsh # snapshot-revert  –domain server8-a flat-os</p>

<p>克隆一个虚拟机到新文件（用于模板的复制创建新vm，或者vm的备份）<br />
[root@w540 Desktop]# virt-clone -o rhel70-tmp -n rhel70-tmp-clone -f /data/vm/cloned-new-vm.img<br />
Cloning rhel7-tmp.img                                                                             | 195 GB  00:00:03     <br />
Clone ‘rhel70-tmp-clone’ created successfully.</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2014-12-24T09:43:03+08:00"><a href="http://martinliu.cn/2014/12/24/wget-e4-b8-8b-e8-bd-bd-e5-a4-a7-e6-96-87-e4-bb-b6-e6-96-ad-e7-82-b9-e7-bb-ad-e4-bc-a0/">December 24, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://martinliu.cn/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://martinliu.cn/2014/12/24/wget-e4-b8-8b-e8-bd-bd-e5-a4-a7-e6-96-87-e4-bb-b6-e6-96-ad-e7-82-b9-e7-bb-ad-e4-bc-a0/" rel="bookmark" title="wget 下载大文件-断点续传" itemprop="url">wget 下载大文件-断点续传</a></h1>
    
  </header>
  <div class="entry-content">
    <p>举例如下：</p>

<p>wget -c -b -t 0 -O CentOS-7.0-1406-x86_64-Everything.iso  http://mirrors.sohu.com/centos/7/isos/x86_64/CentOS-7.0-1406-x86_64-Everything.iso -o centos.log</p>

<p>下载一个7GB的DVD文件，能够断点续传，能够把状态写入centos.log文件中。具体参数说明如下：</p>

<p>[su_table]</p>
<table>
<tbody>
<tr>

<td>-c
</td>

<td>断点续传
</td>
</tr>
<tr>

<td>-b
</td>

<td>后台下载
</td>
</tr>
<tr>

<td>-t 0
</td>

<td>反复尝试下载，0（零）为不限次数
</td>
</tr>
<tr>

<td>-O file name
</td>

<td>O（大写字母o）下载的文件命名为
</td>
</tr>
<tr>

<td>-o file name
</td>

<td>o（小写字母o）下载的日志保存在文件中
</td>
</tr>
<tr>

<td>URL
</td>

<td>http://mirrors.sohu.com/centos/7/isos/x86_64/CentOS-7.0-1406-x86_64-Everything.iso
</td>
</tr>
</tbody>
</table>
<p>[/su_table]</p>

<p>本文参考：<a href="http://blog.chinaunix.net/uid-14735472-id-111049.html">http://blog.chinaunix.net/uid-14735472-id-111049.html</a></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    
      
        <li><a href="http://martinliu.cn/page14/" class="btn">向前</a></li>
      
    

    
    
      <li><a href="http://martinliu.cn">1</a></li>
    

    
    
      
      
      <li>…</li>
    

    
    
    

    
      
        
        
        
        <li><a href="http://martinliu.cn/page13/">13</a></li>
      
    
      
        
        
        
        <li><a href="http://martinliu.cn/page14/">14</a></li>
      
    
      
        <li><strong class="current-page">15</strong></li>
      
    
      
        
        
        
        <li><a href="http://martinliu.cn/page16/">16</a></li>
      
    
      
        
        
        
        <li><a href="http://martinliu.cn/page17/">17</a></li>
      
    

    
    
      <li>…</li>
    

    
      <li><a href="http://martinliu.cn/page94/">94</a></li>
    

    
    
      <li><a href="http://martinliu.cn/page16/" class="btn">下一页</a></li>
    
  </ul>
</div>



</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2017 Martin Liu.</span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://martinliu.cn/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://martinliu.cn/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-749876-6', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>


          

</body>
</html>