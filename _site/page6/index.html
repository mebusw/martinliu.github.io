<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Latest Posts &#8211; Martin's Blog</title>
<meta name="description" content="DevOps Coach & Cloud Expert">
<meta name="keywords" content="DevOps, Cloud, AWS, HCI, Nutanix, ITSM">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/path.jpg">

<meta name="twitter:title" content="Latest Posts">
<meta name="twitter:description" content="DevOps Coach & Cloud Expert">
<meta name="twitter:creator" content="@zliu">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Latest Posts">
<meta property="og:description" content="DevOps Coach & Cloud Expert">
<meta property="og:url" content="/page6/">
<meta property="og:site_name" content="Martin's Blog">





<link rel="canonical" href="/page6/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Martin's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="/">首页</a></li>
		<li>
			<a href="#">关于</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/avatar.jpg" alt="Martin Liu photo" class="author-photo">
					<h4>Martin Liu</h4>
					<p>DevOps Coach, Cloud Expert, Runner</p>
				</li>
				<li><a href="/about/"><span class="btn btn-inverse">详情</span></a></li>
				<li>
					<a href="mailto:67120666@qq.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/zliu"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				
				<li>
					<a href="https://google.com/+MartinLiu-cn"><i class="fa fa-fw fa-google-plus"></i> Google+</a>
				</li>
				<li>
					<a href="https://linkedin.com/in/liuzheng"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="https://github.com/martinliu"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">文章</a>
			<ul class="dl-submenu">
				<li><a href="/posts/">所有文章</a></li>
				<li><a href="/tags/">所有分类</a></li>
			</ul>
		</li>
		
	    
	    <li><a href="http://www.aws-faq.com" target="_blank">AWS-FAQ</a></li>
	  
	    
	    <li><a href="http://devopscoach.org" target="_blank">DevOps教练</a></li>
	  
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  
  
    <div class="entry-image">
      <img src="/images/path.jpg" alt="Latest Posts">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Martin's Blog</h1>
      <h2>Latest Posts</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-18T21:29:45+08:00"><a href="/2015/07/18/atomic-host-e5-8e-9f-e5-ad-90-e4-b8-bb-e6-9c-ba-e6-9c-80-e7-ae-80-e6-b5-8b-e8-af-95/">July 18, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~7 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2015/07/18/atomic-host-e5-8e-9f-e5-ad-90-e4-b8-bb-e6-9c-ba-e6-9c-80-e7-ae-80-e6-b5-8b-e8-af-95/" rel="bookmark" title="Atomic Host 原子主机最简测试" itemprop="url">Atomic Host 原子主机最简测试</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="section">环境准备</h2>

<p>本文使用笔记本电脑+KVM虚拟化进行以下的测试过程，当然也可以用其它的操作系统加虚拟化软件的组合，测试机需要满足以下的条件：
测试虚拟机的建议配置1C/2GB/10GB
虚拟机使用的网络需要能连接到互联网
虚拟机需要能加载光盘iso文件
可以执行起停虚拟机操作，能通过控制它登陆来做初始化配置</p>

<p>本文测试机是Lenovo T440s笔记本电脑，安装的操作系统是Fedora 22，使用KVM虚拟化，用Virt-Manager做GUI图形管理工具。建立了一个NAT的静态虚拟网络，虚拟机可以使用该网络来从互联网下载需要的文件包。</p>

<p>下载Fedora Atomic Host虚拟机文件；下载页面： <a href="http://www.projectatomic.io/download/">http://www.projectatomic.io/download/</a> 点击绿色的下载按钮。下载qcow2格式的Atomic Host虚拟机文件。复制下载的文件到虚拟机运行的存储目录中，文件名可以是master.qcow2，新测试虚拟机会基于它创建。</p>

<p>在通过这个虚拟机模版文件生成测试机前，需要准备一个init.iso的文件，用来初始化测试机的主机名和初始用户密码。</p>

<p>[bash]
[root@martin-fedora vm]# cat meta-data
instance-id: master
local-hostname: master.xenlab.com
[root@martin-fedora vm]# cat user-data
#cloud-config
password: smartvm
ssh_pwauth: True
chpasswd: { expire: False }
[root@martin-fedora vm]# genisoimage -output init.iso -volid cidata -joliet -rock user-data meta-data
I: -input-charset not specified, using utf-8 (detected in locale settings)
Total translation table size: 0
Total rockridge attributes bytes: 331
Total directory bytes: 0
Path table size(bytes): 10
Max brk space used 0
183 extents written (0 MB)
[/bash]</p>

<p>以上的两个配置文件meta-data和user-data，最后使用genisoimage命令生成出文件init.iso。至此，Atomic Host 测试机的运行镜像文件和初始化配置文件都准备好了。</p>

<h2 id="atomic-host">创建Atomic host测试虚拟机</h2>

<p>使用虚拟化的管理工具基于准备好的镜像文件（master.qcow2）创建测新的试虚拟机。在首次启动前，还需要添加光驱设备，指定光驱设备在启动时加载上文中创建的init.iso配置参数文件。
首次在虚拟管理工具上启动新创建的Atomic Host测试虚拟机，查看整个的启动过程。由于本文的测试网络不是DHCP的，因此测试机在启动后，还需要登陆虚拟机控制台，使用默认账户，用户名：fedora用户，fedora的密码在前面的配置文件中已经指定。静态IP地址参考的配置文件如下：</p>

<p>[bash]
[fedora@master ~]$ cat /etc/sysconfig/network-scripts/ifcfg-eth0
DEVICE=”eth0”
BOOTPROTO=”static”
ONBOOT=”yes”
TYPE=”Ethernet”
PERSISTENT_DHCLIENT=”yes”
IPADDR=192.168.10.42
NETMASK=255.255.255.0
BROADCAST=192.168.10.255
NETWORK=192.168.10.0
GATEWAY=192.168.10.1</p>

<p>[fedora@master ~]$ cat /etc/resolv.conf
# Generated by NetworkManager
search xenlab.com
nameserver 192.168.10.1
nameserver 8.8.8.8
[fedora@master ~]$
[/bash]</p>

<p>至此，Atomic Host测试虚拟机初始化安装完毕。</p>

<h2 id="atomic-host-1">Atomic Host基本操作</h2>

<p>登陆Atomic Host测试虚拟机 master 之后首先需要测试是否能和互联网连接，ping外部的网址，看是否能够正常解析。由于后面很多相关测试都需要从联网下载内容。
用ssh工具登陆之后，看下它：
[bash]
[fedora@master ~]$ cat /etc/redhat-release
Fedora release 22 (Twenty Two)
[fedora@master ~]$ uname -a
Linux master.xenlab.com 4.0.4-301.fc22.x86_64 #1 SMP Thu May 21 13:10:33 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
[fedora@master ~]$ dnf
bash: dnf: command not found
[fedora@master ~]$ yum
bash: yum: command not found
[/bash]</p>

<p>根据以上显示发现它貌似就是一个Fedora 22 的服务器，不过默认没有dnf, yum包管理工具，不过有rpm。查询一下这个系统上有什么默认安装的软件包：根据rpm -qa 结果显示，Atomic Host 虚拟机默认安装了324个软件包。下面初步尝试一下 Atomic Host 操作系统更新和管理的主要命令 atomic / rpm-ostree</p>

<p>[bash]
[fedora@master ~]$ sudo atomic
usage: atomic [-h] {host,info,install,run,uninstall,update} …</p>

<p>Atomic Management Tool</p>

<p>positional arguments:
{host,info,install,run,uninstall,update}
commands
host execute Atomic host commands
info display label information about an image
install execute container image install method
run execute container image run method
uninstall execute container image uninstall method
update pull latest container image from repository</p>

<p>optional arguments:
-h, –help show this help message and exit</p>

<p>error: too few arguments
[fedora@master ~]$ sudo rpm-ostree
Usage:
rpm-ostree [OPTION…] COMMAND</p>

<p>Builtin Commands:
compose
upgrade
rebase
rollback
status
db</p>

<p>Help Options:
-h, –help Show help options</p>

<p>Application Options:
–version Print version information and exit</p>

<p>error: No command specified</p>

<p>[fedora@master ~]$ sudo atomic host status
TIMESTAMP (UTC) VERSION ID OSNAME REFSPEC
* 2015-05-21 19:01:46 22.17 06a63ecfcf fedora-atomic fedora-atomic:fedora-atomic/f22/x86_64/docker-host
[fedora@master ~]$ sudo rpm-ostree status
[fedora@master ~]$ sudo atomic host
usage: atomic host [-h] {rollback,status,upgrade} …</p>

<p>positional arguments:
{rollback,status,upgrade}
host commands
rollback switch to alternate tree at boot
status list information about all deployments
upgrade upgrade to the latest Atomic tree if one is available</p>

<p>optional arguments:
-h, –help show this help message and exit</p>

<p>error: too few arguments
[fedora@master ~]$
[/bash]</p>

<p>下面使用 atomic host upgrade 来升级这个系统，使它运行在最新的补丁和版本下。这个过程需要下载180+MB的升级包，这个过程无法断点续传，但是可以任意中断。再次运行该命令后，可以重新从头下载，直到下载成功。下载成功并升级成功以后，重起操作系统。</p>

<p>[bash]
[fedora@master ~]$ sudo atomic host upgrade
Updating from: fedora-atomic:fedora-atomic/f22/x86_64/docker-host</p>

<p>0 metadata, 5051 content objects fetched; 183267 KiB transferred in 330 seconds
Copying /etc changes: 25 modified, 0 removed, 41 added
Transaction complete; bootconfig swap: yes deployment count change: 1
Changed:
avahi-autoipd-0.6.31-31.fc22.x86_64
avahi-libs-0.6.31-31.fc22.x86_64
………………………………………….
tcpdump-14:4.7.4-2.fc22.x86_64
tzdata-2015e-1.fc22.noarch
udisks2-2.1.6-1.fc22.x86_64
Removed:
docker-storage-setup-0.0.4-2.fc22.noarch
pciutils-libs-3.3.0-1.fc22.x86_64
Added:
docker-selinux-1.7.0-6.git74e7a7a.fc22.x86_64
iptables-services-1.4.21-14.fc22.x86_64
kubernetes-master-0.20.0-0.3.git835eded.fc22.x86_64
kubernetes-node-0.20.0-0.3.git835eded.fc22.x86_64
python-pip-6.0.8-1.fc22.noarch
python-setuptools-17.1.1-3.fc22.noarch
Upgrade prepared for next boot; run “systemctl reboot” to start a reboot
[/bash]</p>

<p>在reboot之后，这个系统就可以投入使用了。在启动的GRUB菜单上可以看到出现两个条目，默认进入最新的这个系统版本。</p>

<p>[bash]
[fedora@master ~]$ sudo atomic host status
TIMESTAMP (UTC) VERSION ID OSNAME REFSPEC
* 2015-07-15 23:33:20 22.61 db540a53ba fedora-atomic fedora-atomic:fedora-atomic/f22/x86_64/docker-host
2015-05-21 19:01:46 22.17 06a63ecfcf fedora-atomic fedora-atomic:fedora-atomic/f22/x86_64/docker-host
[/bash]</p>

<p>进入系统之后，我们看到上面这个命令输出，目前 Atomic Host 的操作系统有了两个版本，该系统可以从最新的系统回退或者回滚到旧的版本。可以认为它同时具有多个可以前后切换的操作系统版本。</p>

<p>在一个Atomic Host上有两种软件交付方式：
rpm-ostree 管理部署和升级host系统自身的软件
Linux 容器（目前Docker）提供很多容器来跑各种软件应用服务</p>

<h2 id="docker">运行第一个Docker镜像</h2>

<p>现在测试的是Atomic Host自身的管理工具，传统的Linux系统中，这个软件是用rpm包和系统服务的方式，被安装到被管理节点的，可是我们下面使用容器的技术来部署，也达到相同的管理功能。Cockpit是之前介绍过的一款系统管理工具，兼具对docker的管理功能，它可以Docker image的形式被下载，并且运行在本机的一个专有权限（提权）的容器中。它可以作为Atomic Host的主机管理工具，对Linix系统管理不熟练的人可以使用这个图形工具，查看和监控系统的状态，并且可以管理容器中Image。下面是安装和运行这个特殊功能容器的命令。</p>

<p>[bash]
[fedora@a1 etc]$ sudo atomic run cockpit/ws
/usr/bin/docker run -d –privileged –pid=host -v /:/host cockpit/ws /container/atomic-run –local-ssh
efd3cbbad8452ff394e1d1a0c309870634207538597ba0cead26d790510e7a5e
[/bash]</p>

<p>上面这条命令执行完后，就可以在笔记本电脑的浏览器，输入网址，来访问这个工具，如： https://192.168.10.41:9090 登陆的用户名和密码是 Atomic Host的fedora和它的密码。</p>

<h2 id="hw">HW实战篇</h2>

<p>不错HW就是Hello World！它太有名了，掠过对它的介绍。现在可以让docker命令出场了。在命令行中不加任何参数，看下它的默认输出。输出一下它的版本信息。</p>

<p>[bash]
[fedora@master ~]$ sudo docker version
Client version: 1.7.0.fc22
Client API version: 1.19
Package Version (client): docker-1.7.0-6.git74e7a7a.fc22.x86_64
Go version (client): go1.4.2
Git commit (client): 74e7a7a/1.7.0
OS/Arch (client): linux/amd64
Server version: 1.7.0.fc22
Server API version: 1.19
Package Version (server): docker-1.7.0-6.git74e7a7a.fc22.x86_64
Go version (server): go1.4.2
Git commit (server): 74e7a7a/1.7.0
OS/Arch (server): linux/amd64
[/bash]</p>

<p>下面的实战内容是和过程如下：</p>

<ol>
  <li>
    <p>下载fedora image</p>
  </li>
  <li>
    <p>构建httpd image</p>
  </li>
  <li>
    <p>构建HW主页</p>
  </li>
  <li>
    <p>构建并测试HW网站</p>
  </li>
</ol>

<p>具体的命令执行过程如下：</p>

<p>[bash]
[fedora@master ~]$ sudo docker run -i -t fedora bash
Unable to find image ‘fedora:latest’ locally
latest: Pulling from docker.io/fedora
ded7cd95e059: Already exists
48ecf305d2cf: Already exists
docker.io/fedora:latest: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.
Digest: sha256:10ba981a70632d7764c21deae25c6521db6d39730e1dd8caff90719013858a7b
Status: Downloaded newer image for docker.io/fedora:latest
[root@f1c79aa4c931 /]# dnf update -y
Fedora 22 - x86_64 608 kB/s | 41 MB 01:09
Fedora 22 - x86_64 - Updates 439 kB/s | 12 MB 00:27
Last metadata expiration check performed 0:00:19 ago on Fri Jul 17 13:30:18 2015.
Dependencies resolved.
============================================================================================================================================
Package Arch Version Repository Size
============================================================================================================================================
Installing:
python-pip noarch 6.0.8-1.fc22 fedora 1.7 M
python-setuptools noarch 17.1.1-3.fc22 updates 425 k
Upgrading:
bash x86_64 4.3.39-4.fc22 updates 1.6 M</p>

<p>……………………………………….</p>

<h1 id="transaction-summary">Transaction Summary</h1>
<p>Install 2 Packages
Upgrade 59 Packages
Total download size: 48 M
Downloading Packages:
(1/61): python-pip-6.0.8-1.fc22.noarch.rpm 434 kB/s | 1.7 MB 00:03
…………………………………………………….
Installed:
python-pip.noarch 6.0.8-1.fc22 python-setuptools.noarch 17.1.1-3.fc22</p>

<p>Upgraded:
bash.x86_64 4.3.39-4.fc22 bash-completion.noarch 1:2.1-7.20150513git1950590.fc22
coreutils.x86_64 8.23-10.fc22 curl.x86_64 7.40.0-5.fc22
…………………………………………………………………………………..
systemd.x86_64 219-19.fc22 systemd-libs.x86_64 219-19.fc22
tzdata.noarch 2015e-1.fc22</p>

<p>Complete!
[root@f1c79aa4c931 /]#
[root@f1c79aa4c931 /]#
[/bash]
上面的过程下载和启动了一个fedora，然后更新系统到最新的包，为安装Web服务器打好了基础。</p>

<p>[bash]
[root@f1c79aa4c931 /]# dnf install -y <a href="httpd">httpd</a>
Last metadata expiration check performed 0:06:11 ago on Fri Jul 17 13:30:18 2015.
Dependencies resolved.
============================================================================================================================================
Package Arch Version Repository Size
============================================================================================================================================
Installing:
apr x86_64 1.5.1-3.fc22 fedora 111 k
apr-util x86_64 1.5.4-1.fc22 fedora 96 k
fedora-logos-<a href="httpd">httpd</a> noarch 22.0.0-1.fc22 fedora 33 k
<a href="httpd">httpd</a> x86_64 2.4.12-1.fc22 fedora 1.2 M
<a href="httpd-filesystem">httpd-filesystem</a> noarch 2.4.12-1.fc22 fedora 24 k
<a href="httpd-tools">httpd-tools</a> x86_64 2.4.12-1.fc22 fedora 87 k
mailcap noarch 2.1.44-1.fc22 fedora 36 k</p>

<h1 id="transaction-summary-1">Transaction Summary</h1>
<p>Install 7 Packages</p>

<p>Total download size: 1.6 M
Installed size: 4.4 M
Downloading Packages:
(1/7): apr-1.5.1-3.fc22.x86_64.rpm 128 kB/s | 111 kB 00:00
(2/7): apr-util-1.5.4-1.fc22.x86_64.rpm 100 kB/s | 96 kB 00:00
(3/7): <a href="httpd-filesystem-2.4.12-1.fc22.noarch.rpm">httpd-filesystem-2.4.12-1.fc22.noarch.rpm</a> 123 kB/s | 24 kB 00:00
(4/7): mailcap-2.1.44-1.fc22.noarch.rpm 123 kB/s | 36 kB 00:00
(5/7): <a href="httpd-tools-2.4.12-1.fc22.x86_64.rpm">httpd-tools-2.4.12-1.fc22.x86_64.rpm</a> 185 kB/s | 87 kB 00:00
(6/7): fedora-logos-<a href="httpd-22.0.0-1.fc22.noarch.rpm">httpd-22.0.0-1.fc22.noarch.rpm</a> 151 kB/s | 33 kB 00:00
(7/7): <a href="httpd-2.4.12-1.fc22.x86_64.rpm">httpd-2.4.12-1.fc22.x86_64.rpm</a> 363 kB/s | 1.2 MB 00:03
——————————————————————————————————————————————–
Total 264 kB/s | 1.6 MB 00:06
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
Installing : apr-1.5.1-3.fc22.x86_64 1/7
warning: Unable to get systemd shutdown inhibition lock
Installing : apr-util-1.5.4-1.fc22.x86_64 2/7
Installing : <a href="httpd-tools-2.4.12-1.fc22.x86_64">httpd-tools-2.4.12-1.fc22.x86_64</a> 3/7
Installing : fedora-logos-<a href="httpd-22.0.0-1.fc22.noarch">httpd-22.0.0-1.fc22.noarch</a> 4/7
Installing : mailcap-2.1.44-1.fc22.noarch 5/7
Installing : <a href="httpd-filesystem-2.4.12-1.fc22.noarch">httpd-filesystem-2.4.12-1.fc22.noarch</a> 6/7
Installing : <a href="httpd-2.4.12-1.fc22.x86_64">httpd-2.4.12-1.fc22.x86_64</a> 7/7
Verifying : <a href="httpd-2.4.12-1.fc22.x86_64">httpd-2.4.12-1.fc22.x86_64</a> 1/7
Verifying : apr-1.5.1-3.fc22.x86_64 2/7
Verifying : apr-util-1.5.4-1.fc22.x86_64 3/7
Verifying : <a href="httpd-filesystem-2.4.12-1.fc22.noarch">httpd-filesystem-2.4.12-1.fc22.noarch</a> 4/7
Verifying : <a href="httpd-tools-2.4.12-1.fc22.x86_64">httpd-tools-2.4.12-1.fc22.x86_64</a> 5/7
Verifying : mailcap-2.1.44-1.fc22.noarch 6/7
Verifying : fedora-logos-<a href="httpd-22.0.0-1.fc22.noarch">httpd-22.0.0-1.fc22.noarch</a> 7/7</p>

<p>Installed:
apr.x86_64 1.5.1-3.fc22 apr-util.x86_64 1.5.4-1.fc22 fedora-logos-<a href="httpd.noarch">httpd.noarch</a> 22.0.0-1.fc22 <a href="httpd.x86_64">httpd.x86_64</a> 2.4.12-1.fc22
<a href="httpd-filesystem.noarch">httpd-filesystem.noarch</a> 2.4.12-1.fc22 <a href="httpd-tools.x86_64">httpd-tools.x86_64</a> 2.4.12-1.fc22 mailcap.noarch 2.1.44-1.fc22</p>

<p>Complete!
[root@f1c79aa4c931 /]#
[root@f1c79aa4c931 /]# exit
exit
[fedora@master ~]$
[/bash]
上面在一个互动的Bash里面完成了httpd的安装，exit命令之后，容器会停止运行，可以把这个停下来的镜像文件用下面的命令提交到本地的image库中。</p>

<p>[bash]
[fedora@master ~]$ sudo docker ps -a
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
f1c79aa4c931 fedora “bash” 17 minutes ago Exited (130) 3 minutes ago desperate_franklin
[fedora@master ~]$ sudo docker commit f1c79aa4c931 fedora-<a href="httpd">httpd</a>
c77c91fd4af681e736afc2ec76fc316732e25f52f6f3dd8aa97c973f28c55eb2
[fedora@master ~]$ sudo docker images
REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE
fedora-<a href="httpd">httpd</a> latest c77c91fd4af6 25 seconds ago 605.7 MB
docker.io/cockpit/ws latest 9a4331b694a6 3 weeks ago 572.2 MB
docker.io/fedora latest ded7cd95e059 7 weeks ago 186.5 MB
[/bash]</p>

<p>第一个名为 “fedora-httpd” 的就是刚才安装完毕之后，停止的docker image，用commit提交到本第的库中待用。下面开始准备网站的内容，其实只有一个主页，上只有一句话“HW”</p>

<p>[bash]
[fedora@master ~]$ pwd
/home/fedora
[fedora@master ~]$ vi index.html
[fedora@master ~]$ cat index.html
Hello World!
[fedora@master ~]$ tar -cf mysite.tar index.html
[fedora@a1 ~]$ ls
Dockerfile index.html mysite mysite.tar
[fedora@master ~]$ vi Dockerfile
[fedora@master ~]$ cat Dockerfile
FROM fedora-<a href="httpd">httpd</a>
MAINTAINER MartinLiu<a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#109;&#097;&#114;&#116;&#105;&#110;&#064;&#097;&#119;&#115;&#045;&#102;&#097;&#113;&#046;&#099;&#111;&#109;">&#109;&#097;&#114;&#116;&#105;&#110;&#064;&#097;&#119;&#115;&#045;&#102;&#097;&#113;&#046;&#099;&#111;&#109;</a></p>

<h1 id="add-the-tar-file-of-the-web-site">Add the tar file of the web site</h1>
<p>ADD mysite.tar /tmp/</p>

<h1 id="docker-automatically-extracted-so-move-files-to-web-directory">Docker automatically extracted. So move files to web directory</h1>
<p>RUN cp /tmp/index.html /var/www/html</p>

<p>EXPOSE 80</p>

<p>ENTRYPOINT [ “/usr/sbin/<a href="httpd">httpd”</a> ]
CMD [ “-D”, “FOREGROUND” ]
[/bash]</p>

<p>上面这段命令中最重要的是 Dockerfiler 文件，这个文件的语法还有很多，以上是一个最简化的例子。使用它可构建一个具有静态页面内容的网站。下面开始构建这个网站的Docker image。</p>

<p>[bash]
[fedora@a1 ~]$ sudo docker build -rm -t mysite .
Warning: ‘-rm’ is deprecated, it will be replaced by ‘–rm’ soon. See usage.
Sending build context to Docker daemon 31.74 kB
Sending build context to Docker daemon
Step 0 : FROM fedora-<a href="httpd">httpd</a>
—&gt; 05ce6f68d3f2
Step 1 : MAINTAINER A D Ministator email: martin@aws-faq.com
—&gt; Running in 7ee99e26ab76
—&gt; 03cc8c0deff1
Removing intermediate container 7ee99e26ab76
Step 2 : ADD mysite.tar /tmp/
—&gt; 52abfb1966ad
Removing intermediate container e6c20f7ca5ed
Step 3 : RUN mv /tmp/* /var/www/html
—&gt; Running in ef455353caff
—&gt; 6e24f9a9ea6f
Removing intermediate container ef455353caff
Step 4 : EXPOSE 80
—&gt; Running in 252b59576b54
—&gt; 7dd7c049c9d2
Removing intermediate container 252b59576b54
Step 5 : ENTRYPOINT /usr/sbin/<a href="httpd">httpd</a>
—&gt; Running in 572c3dafa53a
—&gt; fa01c160e081
Removing intermediate container 572c3dafa53a
Step 6 : CMD -D FOREGROUND
—&gt; Running in b133650a6e18
—&gt; f828e1847160
Removing intermediate container b133650a6e18
Successfully built f828e1847160</p>

<p>[fedora@master ~]$ sudo docker images
REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE
mysite latest 1bd6d7c1970f 45 seconds ago 605.7 MB
fedora-<a href="httpd">httpd</a> latest c77c91fd4af6 18 minutes ago 605.7 MB
docker.io/cockpit/ws latest 9a4331b694a6 3 weeks ago 572.2 MB
docker.io/fedora latest ded7cd95e059 7 weeks ago 186.5 MB</p>

<p>[fedora@master ~]$ sudo docker run -d -P mysite
6122ac7d4dff6cc73c4abc1523ac5dd02606c90d4e42da64823942d787694c1f
[fedora@master ~]$ sudo docker ps
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
6122ac7d4dff mysite “/usr/sbin/<a href="httpd">httpd</a> -D 37 seconds ago Up 35 seconds 0.0.0.0:32768-&gt;80/tcp evil_bardeen
e5032443ab69 cockpit/ws “/container/atomic-r 16 minutes ago Up 16 minutes stoic_sammet
[fedora@master ~]$ curl localhost:32768
Hello World!
[/bash]</p>

<p>在最后的命令行输出中，成功的看到了Hello World!的出现。用的是curl的命令行 web 浏览器。</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-14T22:20:24+08:00"><a href="/2015/07/14/e7-ba-a2-e5-b8-bd-e5-aa-92-e4-bd-93-e6-97-a5/">July 14, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2015/07/14/e7-ba-a2-e5-b8-bd-e5-aa-92-e4-bd-93-e6-97-a5/" rel="bookmark" title="红帽媒体日" itemprop="url">红帽媒体日</a></h1>
    
  </header>
  <div class="entry-content">
    <p>本次演讲用了大约25分钟，超时了大约5分钟多，但是其中有些观点还是没有叙述的很倒位。只能算是我的一种理解和解读，希望对道场的媒体朋友们对认识红帽公司有帮助。</p>

<p>演讲源版slide和录音在这个网页上： <a href="http://investors.redhat.com/events.cfm">http://investors.redhat.com/events.cfm</a> 的这部分：</p>
<table cellpadding="0" class="wsh-dataTable wsh-events" summary="">
<tbody>
<tr>

<td data-before="Date">


Jun 24, 2015




10:30 AM - 1:00 PM ET

</td>

<td data-before="Details">


Red Hat Analyst Day




[ Listen to webcast ](http://edge.media-server.com/m/p/mhayc7rh)






[View Presentation](http://investors.redhat.com/common/download/download.cfm?companyid=RHAT&amp;fileid=838366&amp;filekey=633328A1-EAD6-471D-9934-C43F4CDC5666&amp;filename=RH_Summit_Analyst_Day_FINAL.pdf)


12.2 MB




[Add to Briefcase](http://investors.redhat.com/events.cfm#)







View Additional Information

</td>
</tr>
</tbody>
</table>
<p>我做了Pual这一段的翻译，翻译的文档下载点这里：<a href="http://cdn1.martinliu.cn/wp-content/uploads/2015/07/RH_Summit_Analyst_Day_Master_20150714_MartinLiu.pdf">RH_Summit_Analyst_Day_Master_20150714_MartinLiu</a></p>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-12T19:16:44+08:00"><a href="/2015/07/12/ovirt-e6-9c-8d-e5-8a-a1-e5-99-a8-e8-99-9a-e6-8b-9f-e5-8c-96-e6-b5-8b-e8-af-95/">July 12, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~5 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2015/07/12/ovirt-e6-9c-8d-e5-8a-a1-e5-99-a8-e8-99-9a-e6-8b-9f-e5-8c-96-e6-b5-8b-e8-af-95/" rel="bookmark" title="Ovirt 服务器虚拟化测试" itemprop="url">Ovirt 服务器虚拟化测试</a></h1>
    
  </header>
  <div class="entry-content">
    <p>本文安装和测试的软件是Ovirt+KVM的服务器虚拟化，这两个项目是红帽RHEVM+KVM服务器虚拟化的上游社区产品。可以通过这个文档清晰的了解到红帽服务器虚拟化产品的大体功能，基本特点。本测试文档使用的是Centos7+社区yum 源；因此是最新的ovirt和kvm的功能。如果是正式的企业级需求测试，请使用光纤或者传统存储，从而达到和vmware等商业产品最好的类比测试。尽量避免使用嵌套kvm虚拟化的方式，除非您很熟悉Linux，使用两个笔记本是最简单的测试环境。</p>

<p>下图是Ovirt服务器的详细架构图。其中的ovirt-engine是本文安装和部署的部分，是用一个centos7的虚拟机安装的。Host1也是用一个centos7的虚拟机安装的。半年之前我也配置过一次嵌套kvm，根本是一头雾水，而且还没有成功，不过这次的配置过程却这么简单容易，就正常工作了。希望简单一点的人，可以把Host1用物理机来安装，也会节省很多时间。</p>

<p>[caption id=”attachment_53901” align=”alignnone” width=”512”]<img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/07/ovirt-512px-Architecture.png" alt="ovirt 架构图" /> ovirt 架构图[/caption]</p>

<h2 id="kvm">KVM嵌套虚拟化准备</h2>

<p>在测试KVM服务器虚拟化的过程中，如果您能有独立的物理机跑Hypervisor，那么您可以忽略本节。至今进入ovirt的安装。 下面的测试的物理机是 Lenovo T440s 笔记本，运行的 Fedora 22 操作系统，使用 KVM manager 做虚拟机的管理工具。本次测试用到两个虚拟机：</p>

<ol>
  <li>
    <p>ovirt: 运行服务器虚拟化的管理机ovirt，这个程序类似于vmware 的 vcenter。</p>
  </li>
  <li>
    <p>ovirt-host : 用来被ovirt管理的hypervisor；使用 kvm 嵌套 kvm 的方式，来跑虚拟机。</p>
  </li>
</ol>

<p>确认本机的服务器虚拟机CPU Bios配置正常。</p>

<p>[bash]</p>

<p>egrep -c ‘(vmx|svm)’ /proc/cpuinfo
4</p>

<p>[/bash]</p>

<p>本机是i5的CPU，双核开启超线程，显示为4。还没有启用嵌套KVM的虚拟机，需要新建下面这个配置文件，操作系统不同，可能稍微不同，下面是以 Fedora 22 为例。</p>

<p>vi /etc/modprobe.d/kvm-nested.conf
编辑以上文件，增加下面这行参数即可
options kvm_intel nested=1</p>

<p>运行下面的命令，为操作系统内核加載此功能。</p>

<p>[bash]</p>

<p>modprobe -r kvm_intel # unload
modprobe kvm_intel # reload again</p>

<p>cat /sys/module/kvm_intel/parameters/nested
Y</p>

<p>[/bash]</p>

<p>用上面最后的cat的命令确认嵌套功能启用正常，看到的是Y即可。</p>

<p>查看本机虚拟化的Cpu相关参数。</p>

<p>[bash]</p>

<p>[root@martin-fedora vm]# virsh capabilities | egrep “/model|/vendor”</p>
<model>Westmere</model>
<vendor>Intel</vendor>
<model>none</model>
<model>dac</model>
<p>[root@martin-fedora vm]#</p>

<p>[/bash]</p>

<p>到此，物理机的相关准备工作完成。下面使用 Martin’s Perfect CentOS7 模板新建一个2C/4Gd的虚拟机 ovirt-host; 用这个虚拟机作为跑虚拟机的hypervisor把建立好的虚拟机先别开机，需要对它的配置做修改。编辑 ovirt-host虚拟机的配置，给这个嵌套的KVM hypervisor 增加和物理机相同的cpu属性。</p>

<p>virsh edit ovirt-host</p>

<p>本嵌套kvm的虚拟机 cpu 参数如下，如果测试的物理机使用非 i5 的 CPU， 实际的配置参数应该和下面不同。</p>

<cpu mode="custom" match="exact">
<model fallback="allow">Westmere</model>
<vendor>Intel</vendor>
<feature policy="require" name="vmx" />
</cpu>

<p>保存配置，启动这个虚拟机，配置好主机名和网络ip地址。安装ovirt yum 源。做 yum update 之后，reboot待用。</p>

<p>[bash]
yum -y update
yum install http://plain.resources.ovirt.org/pub/yum-repo/ovirt-release35.rpm</p>

<p>[/bash]</p>

<h2 id="ovirt-">安装ovirt 服务器虚拟化管理机</h2>

<p>使用 Martin’s Perfect CentOS7 模板新建一个1C/4G 的虚拟机 ovirt；这个虚拟机上还需要配置 NFS 服务器，用来做 跑虚拟机的共享存储和用于存储iso光盘的存储。</p>

<p>安装和配置NFS的过程如下：</p>

<h1 id="nfs-">安装 nfs 服务相关的包</h1>
<p>yum install -y nfs-utils</p>

<h1 id="section">创建存储目录</h1>
<p>mkdir -p /srv/ovirt/{iso,export,sata}
chown -R vdsm:kvm /srv/ovirt/
chmod -R 770 /srv/ovirt/</p>

<p>编辑nfs配置文件 /ect/exports ， 加入下面三行。</p>

<p>/srv/ovirt/iso 192.168.10.0/24(rw,anonuid=36,anongid=36,all_squash)
/srv/ovirt/export 192.168.10.0/24(rw,anonuid=36,anongid=36,all_squash)
/srv/ovirt/sata 192.168.10.0/24(rw,anonuid=36,anongid=36,all_squash)</p>

<p>由于centos 7 的nfs默认是v4，这和ovirt不兼容，需要修改配置文件改为 v3， 编辑 /etc/nfsmount.conf 加入下面两个参数。</p>

<p>Defaultvers=3
Nfsvers=3</p>

<p>#重启动 nfs 服务器 ，设置开机启动服务
systemctl start rpcbind.service &amp;&amp; systemctl enable rpcbind.service
systemctl start nfs-server.service &amp;&amp; systemctl enable nfs-server.service</p>

<p>下面开始安装ovirt服务器。</p>

<p>yum -y update
yum install http://plain.resources.ovirt.org/pub/yum-repo/ovirt-release35.rpm
yum -y install ovirt-engine</p>

<p>安装完后，用 engine-setup 命令配置和部署ovirt 服务器。</p>

<p>[bash]</p>

<p>[root@ovirt ~]# engine-setup
[ INFO ] Stage: Initializing
[ INFO ] Stage: Environment setup
Configuration files: [‘/etc/ovirt-engine-setup.conf.d/10-packaging-jboss.conf’, ‘/etc/ovirt-engine-setup.conf.d/10-packaging.conf’]
Log file: /var/log/ovirt-engine/setup/ovirt-engine-setup-20150711225251-f9k7an.log
Version: otopi-1.3.2 (otopi-1.3.2-1.el7.centos)
[ INFO ] Stage: Environment packages setup
[ INFO ] Yum Downloading: ovirt-3.5-patternfly1-noarch-epel/x86_64 (0%)
[ INFO ] Stage: Programs detection
[ INFO ] Stage: Environment setup
[ INFO ] Stage: Environment customization</p>

<p>–== PRODUCT OPTIONS ==–</p>

<p>Configure Engine on this host (Yes, No) [Yes]: #回车，选择Yes
Configure WebSocket Proxy on this host (Yes, No) [Yes]: #回车，选择Yes</p>

<p>–== PACKAGES ==–</p>

<p>[ INFO ] Checking for product updates…
[ INFO ] No product updates found</p>

<p>–== ALL IN ONE CONFIGURATION ==–</p>

<p>–== NETWORK CONFIGURATION ==–</p>

<p>Setup can automatically configure the firewall on this system.
Note: automatic configuration of the firewall may overwrite current settings.
Do you want Setup to configure the firewall? (Yes, No) [Yes]: No #选择no，由于本机的服务没有安装防火墙
Host fully qualified DNS name of this server [unknown.prolexic.com]: ovirt.xenlab.com #回车继续</p>

<p>–== DATABASE CONFIGURATION ==–</p>

<p>Where is the Engine database located? (Local, Remote) [Local]: #回车，选择 Local 继续
Setup can configure the local postgresql server automatically for the engine to run. This may conflict with existing applications.
Would you like Setup to automatically configure postgresql and create Engine database, or prefer to perform that manually? (Automatic, Manual) [Automatic]: #回车，选择 继续</p>

<p>–== OVIRT ENGINE CONFIGURATION ==–</p>

<p>Engine admin password:
Confirm engine admin password:
[WARNING] Password is weak: it is based on a dictionary word
Use weak password? (Yes, No) [No]: yes
Application mode (Virt, Gluster, Both) [Both]: #回车，选择 Both 继续</p>

<p>–== PKI CONFIGURATION ==–</p>

<p>Organization name for certificate [xenlab.com]:</p>

<p>–== APACHE CONFIGURATION ==–</p>

<p>Setup can configure the default page of the web server to present the application home page. This may conflict with existing applications.
Do you wish to set the application as the default page of the web server? (Yes, No) [Yes]:
Setup can configure apache to use SSL using a certificate issued from the internal CA.
Do you wish Setup to configure that, or prefer to perform that manually? (Automatic, Manual) [Automatic]:</p>

<p>–== SYSTEM CONFIGURATION ==–</p>

<p>Configure an NFS share on this server to be used as an ISO Domain? (Yes, No) [Yes]: no # 选择 no，本测试手工配置NFS，不需要安装程序配置。 继续</p>

<p>–== MISC CONFIGURATION ==–</p>

<p>–== END OF CONFIGURATION ==–</p>

<p>[ INFO ] Stage: Setup validation
[WARNING] Cannot validate host name settings, reason: resolved host does not match any of the local addresses
[WARNING] Less than 16384MB of memory is available</p>

<p>–== CONFIGURATION PREVIEW ==–</p>

<p>Application mode : both
Update Firewall : False
Host FQDN : ovirt.xenlab.com
Engine database name : engine
Engine database secured connection : False
Engine database host : localhost
Engine database user name : engine
Engine database host name validation : False
Engine database port : 5432
Engine installation : True
PKI organization : xenlab.com
Configure local Engine database : True
Set application as default page : True
Configure Apache SSL : True
Configure WebSocket Proxy : True
Engine Host FQDN : ovirt.xenlab.com</p>

<p>Please confirm installation settings (OK, Cancel) [OK]: #回车，选择 OK 继续
[ INFO ] Stage: Transaction setup
[ INFO ] Stopping engine service
[ INFO ] Stopping ovirt-fence-kdump-listener service
[ INFO ] Stopping websocket-proxy service
[ INFO ] Stage: Misc configuration
[ INFO ] Stage: Package installation
[ INFO ] Stage: Misc configuration
[ INFO ] Initializing PostgreSQL
[ INFO ] Creating PostgreSQL ‘engine’ database
[ INFO ] Configuring PostgreSQL
[ INFO ] Creating/refreshing Engine database schema
[ INFO ] Creating CA
[ INFO ] Configuring WebSocket Proxy
[ INFO ] Generating post install configuration file ‘/etc/ovirt-engine-setup.conf.d/20-setup-ovirt-post.conf’
[ INFO ] Stage: Transaction commit
[ INFO ] Stage: Closing up</p>

<p>–== SUMMARY ==–</p>

<p>[WARNING] Less than 16384MB of memory is available
SSH fingerprint: DF:FF:42:14:80:35:E2:7D:68:3A:1F:83:65:6E:89:EA
Internal CA 99:17:7A:42:D0:9D:D7:33:DE:C3:3E:07:EE:15:5D:01:28:63:4A:BF
Web access is enabled at:
http://ovirt.xenlab.com:80/ovirt-engine
https://ovirt.xenlab.com:443/ovirt-engine
Please use the user “admin” and password specified in order to login
In order to configure firewalld, copy the files from
/etc/ovirt-engine/firewalld to /etc/firewalld/services
and execute the following commands:
firewall-cmd -service ovirt-postgres
firewall-cmd -service ovirt-https
firewall-cmd -service ovirt-fence-kdump-listener
firewall-cmd -service ovirt-websocket-proxy
firewall-cmd -service ovirt-http
The following network ports should be opened:
tcp:443
tcp:5432
tcp:6100
tcp:80
udp:7410
An example of the required configuration for iptables can be found at:
/etc/ovirt-engine/iptables.example</p>

<p>–== END OF SUMMARY ==–</p>

<p>[ INFO ] Starting engine service
[ INFO ] Restarting httpd
[ INFO ] Stage: Clean up
Log file is located at /var/log/ovirt-engine/setup/ovirt-engine-setup-20150711225251-f9k7an.log
[ INFO ] Generating answer file ‘/var/lib/ovirt-engine/setup/answers/20150711225734-setup.conf’
[ INFO ] Stage: Pre-termination
[ INFO ] Stage: Termination
[ INFO ] Execution of setup completed successfully</p>

<p>[/bash]</p>

<p>安装成功，用浏览器，访问ovirt 服务器IP地址使用 admin / 密码 登陆管理员控制台，第一次比较慢，验证安装是否完全成功。</p>

<p>使用命令确认nfs
[root@ovirt ~]# showmount -e
Export list for ovirt.xenlab.com:
/srv/ovirt/sata 192.168.10.0/24
/srv/ovirt/export 192.168.10.0/24
/srv/ovirt/iso 192.168.10.0/24</p>

<p>在ovirt服务器中添加这三个存储，然后在命令和中确认iso存储已经可用。</p>

<p>[bash]</p>

<p>[root@ovirt ~]# engine-iso-uploader list
Please provide the REST API password for the admin@internal oVirt Engine user (CTRL+D to abort):
ISO Storage Domain Name | Datacenter | ISO Domain Status
ovirt-iso | Default | active</p>

<p>[/bash]</p>

<p>把需要安装的光盘镜像文件，先复制到ovirt服务器上，然后传入iso存储。</p>

<p>[bash]</p>

<p>[martin@martin-fedora iso]$ scp CentOS-7-x86_64-Minimal-1503-01.iso root@192.168.10.25:/root/
The authenticity of host ‘192.168.10.25 (192.168.10.25)’ can’t be established.
ECDSA key fingerprint is SHA256:KMGYLWZu14ZKaUwizIORgQ598Bpc0PKzNWF0qop2VAQ.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added ‘192.168.10.25’ (ECDSA) to the list of known hosts.
root@192.168.10.25’s password:
CentOS-7-x86_64-Minimal-1503-01.iso 100% 636MB 90.9MB/s 00:07
[martin@martin-fedora iso]$</p>

<p>[/bash]</p>

<p>用这个命令上传光盘。
engine-iso-uploader upload -i ovirt-iso /root/CentOS-7-x86_64-Minimal-1503-01.iso</p>

<p>之后就可以在控制台中创建虚拟机了。在Web界面上安装虚拟机，是需要安装客户的程序的，在 Fedora 22 笔记本中安装它们。
yum install spice-xpi virt-viewer</p>

<p>点击新创建的虚拟机，启动之后，选择控制台，打开后，开始系统安装。</p>

<h2 id="section-1">参考文档</h2>

<p>本文没有做截图，是由于以下参考文档都有相关截图和步骤说明；因此，在使用本文档的过程中，一定要同时打开这几篇文档。</p>

<p><a href="http://www.ovirt.org/Quick_Start_Guide#Install_oVirt_Engine_.28Fedora.29%60">http://www.ovirt.org/Quick_Start_Guide#Install_oVirt_Engine_.28Fedora.29%60</a></p>

<p><a href="http://jensd.be/?p=550">http://jensd.be/?p=550</a></p>

<p><a href="https://xrsa.net/2015/02/04/installing-ovirt-3-5-on-centos-7-hosted-engine/">https://xrsa.net/2015/02/04/installing-ovirt-3-5-on-centos-7-hosted-engine/</a></p>

<p><a href="http://www.server-world.info/en/note?os=Fedora_22&amp;p=kvm&amp;f=8">http://www.server-world.info/en/note?os=Fedora_22&amp;p=kvm&amp;f=8</a></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-09T23:42:07+08:00"><a href="/2015/07/09/boston-nyc-running-log/">July 09, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2015/07/09/boston-nyc-running-log/" rel="bookmark" title="Boston 和 NYC 的 运动日志" itemprop="url">Boston 和 NYC 的 运动日志</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="section">波士顿的跑步</h2>

<h3 id="section-1">第一跑 - 12公里</h3>

<p><a href="http://martinliu.cn/boston-running-log/0709_8/"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/07/0709_8-576x1024.jpg" alt="0709_8" /></a></p>

<p>推辞了饭局的夜跑，跑步过程中被阵雨浇透，找错了回来的桥，路程没有记录完整。</p>

<h3 id="section-2">第二跑 - 8公里</h3>

<p><a href="http://martinliu.cn/boston-running-log/0709_9/"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/07/0709_9-576x1024.jpg" alt="0709_9" /></a></p>

<p>本想跑的比前一次更远，结果起晚了，跑了8公里就被晒的不行，汗狂出，提前失去斗志，返回。这时感觉还是有跑友会更好些。</p>

<h3 id="section-3">第三跑 - 10公里</h3>

<p><a href="http://martinliu.cn/boston-running-log/0709_10/"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/07/0709_10-576x1024.jpg" alt="0709_10" /></a></p>

<p>陪同事满跑10K，在一个海湾处，居然海湾是闭合的，跑了三圈，其实那个Castle Island Park有点意思，可惜没有进去。</p>

<h3 id="section-4">第四跑 - 10公里</h3>

<p><a href="http://martinliu.cn/boston-running-log/0709_11/"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/07/0709_11-576x1024.jpg" alt="0709_11" /></a></p>

<p>领略了市内最繁华的街道，最美的市中心公园，跑过了 林阴道，再次重温河边的感觉，这是下午下班后的跑步，不管你是什么时间，什么地点跑，基本上到处都是跑步的人。</p>

<h2 id="section-5">波士顿骑行</h2>

<h3 id="km">第一次  46.4 km</h3>

<p><a href="http://martinliu.cn/boston-running-log/screenshot_2015-06-25-21-45-21/"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/07/Screenshot_2015-06-25-21-45-21-576x1024.jpeg" alt="Screenshot_2015-06-25-21-45-21" /></a></p>

<p>自行车租金是25刀，下午开完会发现其它两个同伴时差严重，因此我独自骑行出去。骑行的方向其实是波士顿马拉松延伸的方向，只是那个路线是要在公路上的，车多没法骑行那个赛道，骑车出去闲逛，也超过了一个全马的距离，基本上把哈佛和MIT逛清楚了。</p>

<h3 id="km-1">第二次 21.7 km</h3>

<p><a href="http://martinliu.cn/boston-running-log/0709_12/"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/07/0709_12-576x1024.jpg" alt="0709_12" /></a></p>

<p>第二次，本来不想去，可是需要给伙伴去带路，就带他们走了一遍昨天的路，让他们也浏览了我看过的景点。</p>

<h2 id="km-2">纽约跑步 - 中央公园 10KM</h2>

<p><a href="http://martinliu.cn/boston-running-log/0709_14/"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/07/0709_14-576x1024.jpg" alt="0709_14" /></a></p>

<p>中央公园打卡跑过，很满意的得到了这个路线，公园里里面的运动氛围很强，爽跑一圈。</p>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-09T22:31:15+08:00"><a href="/2015/07/09/e9-a6-96-e6-ac-a1-e7-be-8e-e5-9b-bd-e4-b8-9c-e6-b5-b7-e5-b2-b8-e4-b9-8b-e6-97-85/">July 09, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2015/07/09/e9-a6-96-e6-ac-a1-e7-be-8e-e5-9b-bd-e4-b8-9c-e6-b5-b7-e5-b2-b8-e4-b9-8b-e6-97-85/" rel="bookmark" title="首次美国东海岸之旅" itemprop="url">首次美国东海岸之旅</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="section">行程</h2>

<p>在波士顿的住宿是非常完美的体验。先住了两天剑桥的LeMeridien（SPG）；由于6月是我的生日，因此酒店给我加了早餐，使用IBM的企业代码订房确实便宜了一大块。剩下几天住的Westin Waterfront，和另外一个SPG白金卡同事同住，由于是白金卡，所以直接就给升级到套房了，当然附赠免费早餐；今房间一看，很大的两间房间，各自独立的电视和洗手间。</p>

<p>说下在美国第一次做长途BUS的感受，我是在网上定的票。从波士顿到纽约4个多小时的路程，28$的价格。由于我记错了时间，同事开车送我去车站后，我看了票后，才惊醒，到达候车室的时候，我的那班车已经开车15分钟了。车票是电子邮件中的二维码。我问车站的工作人员，他说你需要去standby下一班车，下一班车要过1小时后发车，我到了那边standby的队列中。心里真是有点没谱，如果那个车上没有空位的话，我就残了。还好，开始上车时第一批是买了那班车票的人；第二批是standby的人，还好有空座位。最后一波是需要副现金上车，而没有买票的人，那部分人好像话了50多刀。在开车的过程中没有停车，车上居然有卫生间，就在车的尾部，我也用了一下，确实很方便，很干净。到了纽约之后，一下车我就走向最近地铁站开始了我的纽约之行。</p>

<h2 id="section-1">波士顿</h2>

<p>波士顿有美国的雅典之称，到处透露着历史感，街道相当干净，气温体感非常舒服。这是一个运动的城市每年的波士顿马拉松比赛不知道吸引了多少人，作为一个跑步爱好者，我到此地也算是朝圣之旅了。到的第二天，就有BAA的10公里的比赛，我看到了才意识到，应该提前报名，说不定可以参加上呢！</p>

<p>在波士顿我跑了三次。第一次本想早晨跑，提前规划好的路线，可是早晨下雨，没有跑成。结果晚上回来后，同事拉我去配客户吃饭，没去，夜跑了十二公里。在跑的中间下雨了，是阵雨，淋了我20多分钟，浑身湿透了，快回到酒店的时候雨停了。回来查跑步轨迹一看，还是跑错了路线，返回的桥还是选择错了，回程的路线基本正确。第二次跑步是早晨晨跑，起的有点晚，还是在查尔斯河边和前一次一样，这次看到了很多早晨练习划船的人，非常多的人在河上划着各种船，有些是有教练指导的，有些是自己联系的。第三次是和同事一起，在海边找了一个港口的地方，港口恰好是环形封闭的，跑了3圈，10公里。第四次是开晚会去跑步，在市中心的酒店跑到城市中心公园，有跑回查尔斯河，然后返回，返回过程中遇到上坡下坡，一个人有点累，10公里做罢。回程一边找路一边欣赏城市，也算是把波士顿城区看了仔细。剩下两次运动是骑行，这里骑行的人也很多。自己骑了一次，和同事一起骑行一次，一共50公里。顺便欣赏了哈佛和MIT学校的校园。</p>

<p>波士顿的龙虾不可以不提，吃了三次，后两次在同一家吃的，这家专门做龙虾，吃的非常过瘾。</p>

<h2 id="section-2">纽约</h2>

<p>在纽约我住在airbnb的一个民宅里，主人是个南美小国的人，他没有工作；估计也是租来的房子，然后转祖一间卧室做房东，airbnb算是让他也有钱赚，有生计了。这个公寓里中央公园很近，我去中央公园跑了一次，感觉非常好，那里有浓厚的运动气息，各种人在里面跑步，骑车，散步，骝狗。两次穿过中央公园都有看到跑步比赛。我买了一张5天的地铁票，算是用足了。去了很多景点，感受到了大纽约的感觉。现在感觉纽约一周可以逛的差不多，4天根本不够。我最完美的两天是大都会博物馆和自由女神/爱丽丝岛。大都会博物馆里面我足足泡了一天，停没电了3个讲解器；直到人闭馆赶人，我才走，看了四分之三不到。真是有点走马观花，很多没有看仔细。自由女神像其实可以注册一下，就能够登到它的身体里，到达头部，从眼睛往外看，我也是去了才知道。爱丽丝岛值的仔细看，它是美国移民博物馆，看了它，彻底颠覆了我对美国移民的看法。</p>

<p>时间有限，工作太忙，就这个流水帐，算是总结一下这次美国东岸之旅吧！</p>

<h2 id="section-3">图片</h2>

<p>以下图片都是手机拍摄。</p>

<p>[gallery link=”file” ids=”53844,53845,53846,53847,53848,53849,53850,53851,53852,53853,53854,53855,53856,53857,53858,53859,53860,53861,53862,53863,53871,53865,53866,53867,53868,53869,53870,53873,53874,53877,53876,53875,53878”]</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    
      
        <li><a href="/page5/" class="btn">向前</a></li>
      
    

    
    
      <li><a href="">1</a></li>
    

    
    
      
      
      <li>…</li>
    

    
    
    

    
      
        
        
        
        <li><a href="/page4/">4</a></li>
      
    
      
        
        
        
        <li><a href="/page5/">5</a></li>
      
    
      
        <li><strong class="current-page">6</strong></li>
      
    
      
        
        
        
        <li><a href="/page7/">7</a></li>
      
    
      
        
        
        
        <li><a href="/page8/">8</a></li>
      
    

    
    
      <li>…</li>
    

    
      <li><a href="/page94/">94</a></li>
    

    
    
      <li><a href="/page7/" class="btn">下一页</a></li>
    
  </ul>
</div>



</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2017 Martin Liu.</span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>



          

</body>
</html>