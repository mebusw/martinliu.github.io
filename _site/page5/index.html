<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Latest Posts &#8211; Martin's Blog</title>
<meta name="description" content="DevOps Coach & Cloud Expert">
<meta name="keywords" content="DevOps, Cloud, AWS, HCI, Nutanix, ITSM">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/path.jpg">

<meta name="twitter:title" content="Latest Posts">
<meta name="twitter:description" content="DevOps Coach & Cloud Expert">
<meta name="twitter:creator" content="@zliu">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Latest Posts">
<meta property="og:description" content="DevOps Coach & Cloud Expert">
<meta property="og:url" content="/page5/">
<meta property="og:site_name" content="Martin's Blog">





<link rel="canonical" href="/page5/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Martin's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="/">首页</a></li>
		<li>
			<a href="#">关于</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/avatar.jpg" alt="Martin Liu photo" class="author-photo">
					<h4>Martin Liu</h4>
					<p>DevOps Coach, Cloud Expert, Runner</p>
				</li>
				<li><a href="/about/"><span class="btn btn-inverse">详情</span></a></li>
				<li>
					<a href="mailto:67120666@qq.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/zliu"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				
				<li>
					<a href="https://google.com/+MartinLiu-cn"><i class="fa fa-fw fa-google-plus"></i> Google+</a>
				</li>
				<li>
					<a href="https://linkedin.com/in/liuzheng"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="https://github.com/martinliu"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">文章</a>
			<ul class="dl-submenu">
				<li><a href="/posts/">所有文章</a></li>
				<li><a href="/tags/">所有分类</a></li>
			</ul>
		</li>
		
	    
	    <li><a href="http://www.aws-faq.com" target="_blank">AWS-FAQ</a></li>
	  
	    
	    <li><a href="http://devopscoach.org" target="_blank">DevOps教练</a></li>
	  
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  
  
    <div class="entry-image">
      <img src="/images/path.jpg" alt="Latest Posts">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Martin's Blog</h1>
      <h2>Latest Posts</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-12-29T12:06:28+08:00"><a href="/2015/12/29/iot-e6-98-af-e6-80-8e-e4-b9-88-e8-a2-ab-e9-bb-91-e7-9a-84/">December 29, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2015/12/29/iot-e6-98-af-e6-80-8e-e4-b9-88-e8-a2-ab-e9-bb-91-e7-9a-84/" rel="bookmark" title="IoT 是怎么被黑的？" itemprop="url">IoT 是怎么被黑的？</a></h1>
    
  </header>
  <div class="entry-content">
    <p>IoT有公众的立场，也有厂商的算盘。微软的动作是比较快得，2015年春季就发布了IoT战略，其他厂商IBM，Amazon等等也都有各自的布局。在硬件厂商这一次侧，Raspberry则占据了比较显眼的位置；确实也吸引了比较多的眼球。它从2013年起一气出了很多型号的板子。回忆起来，当时除了记得SoC技术是价格非常便宜的，并没有太多关注这种硬件相关的东西。直到昨天我入手Raspberry 2 model B后，大致玩了一下，我隐约的感觉，今天谈到的 IoT 和以往确实不同了；这或许是” 范在型智能可互联网 “ 时代的到来，智能和wifi的植入是maker们欲罢不能的一件事情，在商业上是必要的卖点和噱头，是用户现实的和潜在的需求；可联网和可连接互联网，绝对是两个层面上的概念；封闭的信息孤岛式的网络已经无法通过自身实现其信息的价值，信息价值的实现必须通过与互联网的链接和互动来实现。联网意味着链接互联网，在哪里信息的融合和分析再反馈回到真实世界中，并完成某种动作，在这个闭环中，真实世界被投射到虚拟世界中去，然后再得到一个预期的反馈，计算机信息处理和控制在过程中起到了推动作用，真实世界中的人或者物对它的一个反馈使之所有抽象而似乎无形的信息技术和互联网实现了存在的价值；这是一种虚拟现实世界和人类主动且有意识地互动。</p>

<p>扯远了，在某东购买的树莓板是这个这样的，如下图：</p>

<p><a href="https://en.wikipedia.org/wiki/Raspberry_Pi"><img src="http://cdn1.martinliu.cn/wp-content/uploads/2015/12/my-pi.jpg" alt="my-pi" /></a></p>

<p>它链接外部世界的方式就是通过板子上面的三个接口，下侧比较明显的排针，中上侧白色竖着的，和中右侧的两个白色排线插头。这些主要是链接传感器用的。另外还包括板载的4个USB口，USB口也可以接外设和Wifi模块。当然还有网线插口。</p>

<p>这是 Raspberry 的2代B型版，它的特点是计算处理能力是比较强劲的。感觉做控制中心比较合适，如智能家庭的总控制中心。它还可以和Arduino组合起来，Arduino 的处理能力较低，可以通过它作为外部传感器的hub，单纯的做信息收集，和动作指令的执行（发出继电器开关的开合信号等）。就某种单一具体的IoT功能的实现，Raspberry和Arduino没有太大的差异。但是在构建复杂系统的时候，把两者结合起来的设计还是多见的。接下来，我可能会去把Amazon上的那个Arduino开发套装买回来，这样就配齐了，当然 Raspberry A型板也可以入。</p>

<p>如果你把所有的东西都连接到互联网了，那么安全性怎么保证？今天在http://www.wired.com 网站上看到的头条就是《How <a href="http://www.wired.com/2015/12/2015-the-year-the-internet-of-things-got-hacked/">IoT got hacked </a>》看完后，不得不倒吸一口凉气。不过安全总是在任何时间点、场合拿出来，可以吓死人的东西。不hack出一些值得被人黑的东西来，那你还能做出什么更有意义的事情呢。以上就是本次树莓派入手记录贴。</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-10-12T14:33:12+08:00"><a href="/2015/10/12/e8-b6-85-e4-ba-ba-e7-bb-84-e6-88-90-e7-9a-84-e5-9b-a2-e9-98-9f-e8-bf-98-e6-98-af-e8-b6-85-e7-ba-a7-e5-9b-a2-e9-98-9f/">October 12, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2015/10/12/e8-b6-85-e4-ba-ba-e7-bb-84-e6-88-90-e7-9a-84-e5-9b-a2-e9-98-9f-e8-bf-98-e6-98-af-e8-b6-85-e7-ba-a7-e5-9b-a2-e9-98-9f/" rel="bookmark" title="超人组成的团队还是超级团队" itemprop="url">超人组成的团队还是超级团队</a></h1>
    
  </header>
  <div class="entry-content">
    <h3 id="supper-chicken-">建议所有管理者都可以反思一下：是否需要supper chicken 团队。先看下这个视频。</h3>

<p>http://video-subtitle.tedcdn.com/talk/podcast/2015W/None/MargaretHeffernan_2015W-480p-zh-tw.mp4</p>

<h3 id="about-the-book">About the book</h3>

<p><img src="https://tedcdnpi-a.akamaihd.net/r/pb-assets.tedcdn.com/system/baubles/files/000/002/439/original/TEDBook_heffernan_cover.jpg?w=320" alt="TED Book: Beyond Measure" /></p>

<p>In this wise and witty guide to creating strong company culture, business leader Margaret Heffernan lays the groundwork for a new kind of thinking: Organizations can create seismic shifts by making deceptively small changes.</p>

<p>Far beyond a prescriptive list, this book spills over with fascinating anecdotes from organizations around the world. Heffernan reveals the surprisingly small changes any organization can make: how to empower every person as a leader: how to open channels as a real, active listening; the important of cutting back hours (and also leaning into crunch time); why leaving the office does wonders for your working brain; how conflict works as an essential tool for creative thinking; why companies that actively solicit involvement beyond their walls are so much more effective; how simple activities strengthen social capital between workers.</p>

<p>Packed with compelling stories and startling statistics, Heffernan takes readers on a tour across the globe. Drawing from her years of experience as a business leader and ultimately proving that it’s often the small changes that make the greatest, most lasting impact.</p>

<blockquote>

&gt; 
&gt; This book is aimed at everyone — from the CEO to the janitor — who wants a better place to work. It looks at the accumulation of small, everyday thoughts and habits that generate and sustain culture: ways of speaking, listening, arguing, thinking, seeing. These aren’t multimillion dollar, multi-year programs; these are small steps that anyone can take at any time, the small steps that mark the beginning of big change.
&gt; 
&gt; </blockquote>

<hr />

<h3 id="press-and-reviews">Press and reviews</h3>

<p>Read a Q&amp;A with Margaret on <em>Huffington Post</em>: <a href="http://www.huffingtonpost.com/lynn-parramore/americas-competition-feti_b_7504540.html">“America’s Competition Fetish Kills Creativity and Produces Human Sheep”</a></p>

<p>An illustrated excerpt from <em>Beyond Measure</em> on MEDIUM: <a href="https://medium.com/@M_Heffernan/small-steps-to-huge-change-a8f86d414ed9">“Small Steps to Huge Change”</a></p>

<p>Read what <em>TIME</em> has to say about <em>Beyond Measure</em>: <a href="http://time.com/3851826/financial-reform/">“The Real Way to Fix Finance Once and for All”</a></p>

<p>A great synopsis of <em>Beyond Measure</em> in <em>Tech Cocktail</em>: <a href="http://tech.co/team-margaret-heffernan-social-capital-2015-05">“What Makes Some Teams Better than Others”</a></p>

<p>Read a wonderful review in <em>The Globe and Mail</em>: <a href="http://www.theglobeandmail.com/report-on-business/careers/management/corporate-culture-the-secret-sauce-of-success/article26091012/">“Corporate culture the ‘secret sauce’ of success”</a></p>

<hr />

<h3 id="about-the-author">About the author</h3>

<p><a href="http://www.ted.com/speakers/margaret_heffernan"><strong>Margaret Heffernan</strong></a> is an entrepreneur, chief executive, and author. She was born in Texas, raised in Holland, and educated at Cambridge University. She worked for the BBC producing television and radio programs and also developed interactive multimedia products with Peter Lynch, Tom Peters, Standard &amp; Poors, and The Learning Company. She has served as Chief Executive Officer for InfoMation Corporation, ZineZone Corporation, and iCAST Corporation. Her book, <em>Willful Blindness</em>, was named one of the best business books of the decade by the <em>Financial Times</em>, and her most recent book, <em>A Bigger Prize</em> won the Transmission Prize in 2015. She blogs for the <em>Huffington Post</em> and Inc.com.</p>

<p><img src="https://tedcdnpi-a.akamaihd.net/r/pb-assets.tedcdn.com/system/baubles/files/000/002/443/original/tedbook_heffernan_headshot.jpg?1428423786?w=320" alt="TED Book author: Margaret Heffernan" /></p>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-09-30T20:45:29+08:00"><a href="/2015/09/30/wordpress-e5-88-9b-e5-a7-8b-e4-ba-ba-e8-8b-b1-e5-b9-b4-e6-97-a9-e9-80-9d-e7-bb-93-e8-82-a0-e7-99-8c/">September 30, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2015/09/30/wordpress-e5-88-9b-e5-a7-8b-e4-ba-ba-e8-8b-b1-e5-b9-b4-e6-97-a9-e9-80-9d-e7-bb-93-e8-82-a0-e7-99-8c/" rel="bookmark" title="Wordpress 创始人英年早逝-结肠癌" itemprop="url">Wordpress 创始人英年早逝-结肠癌</a></h1>
    
  </header>
  <div class="entry-content">
    <p>今天看到这条让人哀伤的新闻，真是感觉很难过。我是一个多年的Wordpress用户，本博客也是wordpress些的，而且记录多年的文章。wordpress是一个能让人很着迷的程序。它是一个__GPLv2__的开源软件。对我来说有一件事情是始终在于之斗争的，这就是“测试/更换wordpress的Theme和插件”；不夸张的说，当一个不需要编写一丁点css/php代码的人也能够完美地控制一个网站的功能和外表的时候，你会觉得渐渐的忽视了这个网站软件本身，你会被一下子陷入到，那浩如烟海的与之共生的生态系统所开发的免费资源中。wordpress具备了开源软件的一个核心特质“提供开放的平台，让周边的开发者和设计师能通过扩展开发来够推动它的用户社区的发展和繁荣”。 以wordpress为核心的周边生态系统有：功能插件、theme设计、SOE咨询、网店功能等等；以上这些养活了互联网上无数的个体或者公司；给无数的网站设计爱好者提供了创造和互动的机会。虽然，我最近对blog软件的注意力渐渐地转向了ghost，但是本站必将持续使用wordpress，会继续一如既往地关注它可能会给用户带来的惊喜，长期使用和关注一个开源软件的体验是无法替代的，是欲罢不能的。仅此献给Alex King，希望他的灵魂能升入天堂，一路走好。</p>

<p>Alex King是wordpress的创始人之一，他的个人blog停止于2015-8-24日的一篇自己关于他的病情的文章，到目前为止有142个回复。<a href="http://alexking.org/about">http://alexking.org/about   </a> 这个页面是他的自述页面。</p>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-09-27T23:03:12+08:00"><a href="/2015/09/27/ghost-e5-8d-9a-e5-ae-a2/">September 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2015/09/27/ghost-e5-8d-9a-e5-ae-a2/" rel="bookmark" title="Ghost 博客" itemprop="url">Ghost 博客</a></h1>
    
  </header>
  <div class="entry-content">
    <p>话说本站也经历过很多变迁，使用的系统主要经历如下：google的blogspot （正式开始写blog的第一篇子在那，后来被墙）–&gt; 某共享wordpress平台（免费，名字已经几乎忘记了）–&gt; 免费国外VPS 主机wordpress (主机的ip很不靠谱，经常被墙) –&gt; 国外付费 VPS wordpress + 国内CDN，现在这样一直快三四年了。</p>

<p>Wordpress用了这么多年下来，真是觉得什么都可以做了，其中有一段时间也捣鼓过一阵子Drupal，但是还是觉得不如wordpress好使，它的功能非常成熟；themes和plugin 的生态系统非常成熟；价格在30～50$的themes我也是买过几个了；可是最后还是维持在了当前这个free theme 。</p>

<p>Ghost 给我的感觉就是简洁、干净和快速。<a href="http://hidocker.io">http://hidocker.io </a>打建的过程中更是让我彻底的感觉到它的这些特点。它依赖的 nodejs和ngnix 两个包都只有几MB大小，它的安装包也很小。因此安装和配置也非常的简单，数量了10分钟之内就完成安装配置。使用了 ghost 两天之后，客观地讲它还是比较初级阶段，很多扩展和的定义都必须修改代码，这可能就会把恐惧修改代码的大批人拒之门外；甚至于安装新的theme这样的工作也是在linux的shell里面完成的。</p>

<p>之后我会发布一篇详细的安装文档到 http://www.aws-faq.com/ 上，点这里 <a href="http://www.aws-faq.com/aws-ec2/ghost-%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE.html">http://www.aws-faq.com/aws-ec2/ghost-%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE.html</a></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-18T21:29:45+08:00"><a href="/2015/07/18/atomic-host-e5-8e-9f-e5-ad-90-e4-b8-bb-e6-9c-ba-e6-9c-80-e7-ae-80-e6-b5-8b-e8-af-95/">July 18, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Martin Liu">Martin Liu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~7 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/2015/07/18/atomic-host-e5-8e-9f-e5-ad-90-e4-b8-bb-e6-9c-ba-e6-9c-80-e7-ae-80-e6-b5-8b-e8-af-95/" rel="bookmark" title="Atomic Host 原子主机最简测试" itemprop="url">Atomic Host 原子主机最简测试</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="section">环境准备</h2>

<p>本文使用笔记本电脑+KVM虚拟化进行以下的测试过程，当然也可以用其它的操作系统加虚拟化软件的组合，测试机需要满足以下的条件：
测试虚拟机的建议配置1C/2GB/10GB
虚拟机使用的网络需要能连接到互联网
虚拟机需要能加载光盘iso文件
可以执行起停虚拟机操作，能通过控制它登陆来做初始化配置</p>

<p>本文测试机是Lenovo T440s笔记本电脑，安装的操作系统是Fedora 22，使用KVM虚拟化，用Virt-Manager做GUI图形管理工具。建立了一个NAT的静态虚拟网络，虚拟机可以使用该网络来从互联网下载需要的文件包。</p>

<p>下载Fedora Atomic Host虚拟机文件；下载页面： <a href="http://www.projectatomic.io/download/">http://www.projectatomic.io/download/</a> 点击绿色的下载按钮。下载qcow2格式的Atomic Host虚拟机文件。复制下载的文件到虚拟机运行的存储目录中，文件名可以是master.qcow2，新测试虚拟机会基于它创建。</p>

<p>在通过这个虚拟机模版文件生成测试机前，需要准备一个init.iso的文件，用来初始化测试机的主机名和初始用户密码。</p>

<p>[bash]
[root@martin-fedora vm]# cat meta-data
instance-id: master
local-hostname: master.xenlab.com
[root@martin-fedora vm]# cat user-data
#cloud-config
password: smartvm
ssh_pwauth: True
chpasswd: { expire: False }
[root@martin-fedora vm]# genisoimage -output init.iso -volid cidata -joliet -rock user-data meta-data
I: -input-charset not specified, using utf-8 (detected in locale settings)
Total translation table size: 0
Total rockridge attributes bytes: 331
Total directory bytes: 0
Path table size(bytes): 10
Max brk space used 0
183 extents written (0 MB)
[/bash]</p>

<p>以上的两个配置文件meta-data和user-data，最后使用genisoimage命令生成出文件init.iso。至此，Atomic Host 测试机的运行镜像文件和初始化配置文件都准备好了。</p>

<h2 id="atomic-host">创建Atomic host测试虚拟机</h2>

<p>使用虚拟化的管理工具基于准备好的镜像文件（master.qcow2）创建测新的试虚拟机。在首次启动前，还需要添加光驱设备，指定光驱设备在启动时加载上文中创建的init.iso配置参数文件。
首次在虚拟管理工具上启动新创建的Atomic Host测试虚拟机，查看整个的启动过程。由于本文的测试网络不是DHCP的，因此测试机在启动后，还需要登陆虚拟机控制台，使用默认账户，用户名：fedora用户，fedora的密码在前面的配置文件中已经指定。静态IP地址参考的配置文件如下：</p>

<p>[bash]
[fedora@master ~]$ cat /etc/sysconfig/network-scripts/ifcfg-eth0
DEVICE=”eth0”
BOOTPROTO=”static”
ONBOOT=”yes”
TYPE=”Ethernet”
PERSISTENT_DHCLIENT=”yes”
IPADDR=192.168.10.42
NETMASK=255.255.255.0
BROADCAST=192.168.10.255
NETWORK=192.168.10.0
GATEWAY=192.168.10.1</p>

<p>[fedora@master ~]$ cat /etc/resolv.conf
# Generated by NetworkManager
search xenlab.com
nameserver 192.168.10.1
nameserver 8.8.8.8
[fedora@master ~]$
[/bash]</p>

<p>至此，Atomic Host测试虚拟机初始化安装完毕。</p>

<h2 id="atomic-host-1">Atomic Host基本操作</h2>

<p>登陆Atomic Host测试虚拟机 master 之后首先需要测试是否能和互联网连接，ping外部的网址，看是否能够正常解析。由于后面很多相关测试都需要从联网下载内容。
用ssh工具登陆之后，看下它：
[bash]
[fedora@master ~]$ cat /etc/redhat-release
Fedora release 22 (Twenty Two)
[fedora@master ~]$ uname -a
Linux master.xenlab.com 4.0.4-301.fc22.x86_64 #1 SMP Thu May 21 13:10:33 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
[fedora@master ~]$ dnf
bash: dnf: command not found
[fedora@master ~]$ yum
bash: yum: command not found
[/bash]</p>

<p>根据以上显示发现它貌似就是一个Fedora 22 的服务器，不过默认没有dnf, yum包管理工具，不过有rpm。查询一下这个系统上有什么默认安装的软件包：根据rpm -qa 结果显示，Atomic Host 虚拟机默认安装了324个软件包。下面初步尝试一下 Atomic Host 操作系统更新和管理的主要命令 atomic / rpm-ostree</p>

<p>[bash]
[fedora@master ~]$ sudo atomic
usage: atomic [-h] {host,info,install,run,uninstall,update} …</p>

<p>Atomic Management Tool</p>

<p>positional arguments:
{host,info,install,run,uninstall,update}
commands
host execute Atomic host commands
info display label information about an image
install execute container image install method
run execute container image run method
uninstall execute container image uninstall method
update pull latest container image from repository</p>

<p>optional arguments:
-h, –help show this help message and exit</p>

<p>error: too few arguments
[fedora@master ~]$ sudo rpm-ostree
Usage:
rpm-ostree [OPTION…] COMMAND</p>

<p>Builtin Commands:
compose
upgrade
rebase
rollback
status
db</p>

<p>Help Options:
-h, –help Show help options</p>

<p>Application Options:
–version Print version information and exit</p>

<p>error: No command specified</p>

<p>[fedora@master ~]$ sudo atomic host status
TIMESTAMP (UTC) VERSION ID OSNAME REFSPEC
* 2015-05-21 19:01:46 22.17 06a63ecfcf fedora-atomic fedora-atomic:fedora-atomic/f22/x86_64/docker-host
[fedora@master ~]$ sudo rpm-ostree status
[fedora@master ~]$ sudo atomic host
usage: atomic host [-h] {rollback,status,upgrade} …</p>

<p>positional arguments:
{rollback,status,upgrade}
host commands
rollback switch to alternate tree at boot
status list information about all deployments
upgrade upgrade to the latest Atomic tree if one is available</p>

<p>optional arguments:
-h, –help show this help message and exit</p>

<p>error: too few arguments
[fedora@master ~]$
[/bash]</p>

<p>下面使用 atomic host upgrade 来升级这个系统，使它运行在最新的补丁和版本下。这个过程需要下载180+MB的升级包，这个过程无法断点续传，但是可以任意中断。再次运行该命令后，可以重新从头下载，直到下载成功。下载成功并升级成功以后，重起操作系统。</p>

<p>[bash]
[fedora@master ~]$ sudo atomic host upgrade
Updating from: fedora-atomic:fedora-atomic/f22/x86_64/docker-host</p>

<p>0 metadata, 5051 content objects fetched; 183267 KiB transferred in 330 seconds
Copying /etc changes: 25 modified, 0 removed, 41 added
Transaction complete; bootconfig swap: yes deployment count change: 1
Changed:
avahi-autoipd-0.6.31-31.fc22.x86_64
avahi-libs-0.6.31-31.fc22.x86_64
………………………………………….
tcpdump-14:4.7.4-2.fc22.x86_64
tzdata-2015e-1.fc22.noarch
udisks2-2.1.6-1.fc22.x86_64
Removed:
docker-storage-setup-0.0.4-2.fc22.noarch
pciutils-libs-3.3.0-1.fc22.x86_64
Added:
docker-selinux-1.7.0-6.git74e7a7a.fc22.x86_64
iptables-services-1.4.21-14.fc22.x86_64
kubernetes-master-0.20.0-0.3.git835eded.fc22.x86_64
kubernetes-node-0.20.0-0.3.git835eded.fc22.x86_64
python-pip-6.0.8-1.fc22.noarch
python-setuptools-17.1.1-3.fc22.noarch
Upgrade prepared for next boot; run “systemctl reboot” to start a reboot
[/bash]</p>

<p>在reboot之后，这个系统就可以投入使用了。在启动的GRUB菜单上可以看到出现两个条目，默认进入最新的这个系统版本。</p>

<p>[bash]
[fedora@master ~]$ sudo atomic host status
TIMESTAMP (UTC) VERSION ID OSNAME REFSPEC
* 2015-07-15 23:33:20 22.61 db540a53ba fedora-atomic fedora-atomic:fedora-atomic/f22/x86_64/docker-host
2015-05-21 19:01:46 22.17 06a63ecfcf fedora-atomic fedora-atomic:fedora-atomic/f22/x86_64/docker-host
[/bash]</p>

<p>进入系统之后，我们看到上面这个命令输出，目前 Atomic Host 的操作系统有了两个版本，该系统可以从最新的系统回退或者回滚到旧的版本。可以认为它同时具有多个可以前后切换的操作系统版本。</p>

<p>在一个Atomic Host上有两种软件交付方式：
rpm-ostree 管理部署和升级host系统自身的软件
Linux 容器（目前Docker）提供很多容器来跑各种软件应用服务</p>

<h2 id="docker">运行第一个Docker镜像</h2>

<p>现在测试的是Atomic Host自身的管理工具，传统的Linux系统中，这个软件是用rpm包和系统服务的方式，被安装到被管理节点的，可是我们下面使用容器的技术来部署，也达到相同的管理功能。Cockpit是之前介绍过的一款系统管理工具，兼具对docker的管理功能，它可以Docker image的形式被下载，并且运行在本机的一个专有权限（提权）的容器中。它可以作为Atomic Host的主机管理工具，对Linix系统管理不熟练的人可以使用这个图形工具，查看和监控系统的状态，并且可以管理容器中Image。下面是安装和运行这个特殊功能容器的命令。</p>

<p>[bash]
[fedora@a1 etc]$ sudo atomic run cockpit/ws
/usr/bin/docker run -d –privileged –pid=host -v /:/host cockpit/ws /container/atomic-run –local-ssh
efd3cbbad8452ff394e1d1a0c309870634207538597ba0cead26d790510e7a5e
[/bash]</p>

<p>上面这条命令执行完后，就可以在笔记本电脑的浏览器，输入网址，来访问这个工具，如： https://192.168.10.41:9090 登陆的用户名和密码是 Atomic Host的fedora和它的密码。</p>

<h2 id="hw">HW实战篇</h2>

<p>不错HW就是Hello World！它太有名了，掠过对它的介绍。现在可以让docker命令出场了。在命令行中不加任何参数，看下它的默认输出。输出一下它的版本信息。</p>

<p>[bash]
[fedora@master ~]$ sudo docker version
Client version: 1.7.0.fc22
Client API version: 1.19
Package Version (client): docker-1.7.0-6.git74e7a7a.fc22.x86_64
Go version (client): go1.4.2
Git commit (client): 74e7a7a/1.7.0
OS/Arch (client): linux/amd64
Server version: 1.7.0.fc22
Server API version: 1.19
Package Version (server): docker-1.7.0-6.git74e7a7a.fc22.x86_64
Go version (server): go1.4.2
Git commit (server): 74e7a7a/1.7.0
OS/Arch (server): linux/amd64
[/bash]</p>

<p>下面的实战内容是和过程如下：</p>

<ol>
  <li>
    <p>下载fedora image</p>
  </li>
  <li>
    <p>构建httpd image</p>
  </li>
  <li>
    <p>构建HW主页</p>
  </li>
  <li>
    <p>构建并测试HW网站</p>
  </li>
</ol>

<p>具体的命令执行过程如下：</p>

<p>[bash]
[fedora@master ~]$ sudo docker run -i -t fedora bash
Unable to find image ‘fedora:latest’ locally
latest: Pulling from docker.io/fedora
ded7cd95e059: Already exists
48ecf305d2cf: Already exists
docker.io/fedora:latest: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.
Digest: sha256:10ba981a70632d7764c21deae25c6521db6d39730e1dd8caff90719013858a7b
Status: Downloaded newer image for docker.io/fedora:latest
[root@f1c79aa4c931 /]# dnf update -y
Fedora 22 - x86_64 608 kB/s | 41 MB 01:09
Fedora 22 - x86_64 - Updates 439 kB/s | 12 MB 00:27
Last metadata expiration check performed 0:00:19 ago on Fri Jul 17 13:30:18 2015.
Dependencies resolved.
============================================================================================================================================
Package Arch Version Repository Size
============================================================================================================================================
Installing:
python-pip noarch 6.0.8-1.fc22 fedora 1.7 M
python-setuptools noarch 17.1.1-3.fc22 updates 425 k
Upgrading:
bash x86_64 4.3.39-4.fc22 updates 1.6 M</p>

<p>……………………………………….</p>

<h1 id="transaction-summary">Transaction Summary</h1>
<p>Install 2 Packages
Upgrade 59 Packages
Total download size: 48 M
Downloading Packages:
(1/61): python-pip-6.0.8-1.fc22.noarch.rpm 434 kB/s | 1.7 MB 00:03
…………………………………………………….
Installed:
python-pip.noarch 6.0.8-1.fc22 python-setuptools.noarch 17.1.1-3.fc22</p>

<p>Upgraded:
bash.x86_64 4.3.39-4.fc22 bash-completion.noarch 1:2.1-7.20150513git1950590.fc22
coreutils.x86_64 8.23-10.fc22 curl.x86_64 7.40.0-5.fc22
…………………………………………………………………………………..
systemd.x86_64 219-19.fc22 systemd-libs.x86_64 219-19.fc22
tzdata.noarch 2015e-1.fc22</p>

<p>Complete!
[root@f1c79aa4c931 /]#
[root@f1c79aa4c931 /]#
[/bash]
上面的过程下载和启动了一个fedora，然后更新系统到最新的包，为安装Web服务器打好了基础。</p>

<p>[bash]
[root@f1c79aa4c931 /]# dnf install -y <a href="httpd">httpd</a>
Last metadata expiration check performed 0:06:11 ago on Fri Jul 17 13:30:18 2015.
Dependencies resolved.
============================================================================================================================================
Package Arch Version Repository Size
============================================================================================================================================
Installing:
apr x86_64 1.5.1-3.fc22 fedora 111 k
apr-util x86_64 1.5.4-1.fc22 fedora 96 k
fedora-logos-<a href="httpd">httpd</a> noarch 22.0.0-1.fc22 fedora 33 k
<a href="httpd">httpd</a> x86_64 2.4.12-1.fc22 fedora 1.2 M
<a href="httpd-filesystem">httpd-filesystem</a> noarch 2.4.12-1.fc22 fedora 24 k
<a href="httpd-tools">httpd-tools</a> x86_64 2.4.12-1.fc22 fedora 87 k
mailcap noarch 2.1.44-1.fc22 fedora 36 k</p>

<h1 id="transaction-summary-1">Transaction Summary</h1>
<p>Install 7 Packages</p>

<p>Total download size: 1.6 M
Installed size: 4.4 M
Downloading Packages:
(1/7): apr-1.5.1-3.fc22.x86_64.rpm 128 kB/s | 111 kB 00:00
(2/7): apr-util-1.5.4-1.fc22.x86_64.rpm 100 kB/s | 96 kB 00:00
(3/7): <a href="httpd-filesystem-2.4.12-1.fc22.noarch.rpm">httpd-filesystem-2.4.12-1.fc22.noarch.rpm</a> 123 kB/s | 24 kB 00:00
(4/7): mailcap-2.1.44-1.fc22.noarch.rpm 123 kB/s | 36 kB 00:00
(5/7): <a href="httpd-tools-2.4.12-1.fc22.x86_64.rpm">httpd-tools-2.4.12-1.fc22.x86_64.rpm</a> 185 kB/s | 87 kB 00:00
(6/7): fedora-logos-<a href="httpd-22.0.0-1.fc22.noarch.rpm">httpd-22.0.0-1.fc22.noarch.rpm</a> 151 kB/s | 33 kB 00:00
(7/7): <a href="httpd-2.4.12-1.fc22.x86_64.rpm">httpd-2.4.12-1.fc22.x86_64.rpm</a> 363 kB/s | 1.2 MB 00:03
——————————————————————————————————————————————–
Total 264 kB/s | 1.6 MB 00:06
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
Installing : apr-1.5.1-3.fc22.x86_64 1/7
warning: Unable to get systemd shutdown inhibition lock
Installing : apr-util-1.5.4-1.fc22.x86_64 2/7
Installing : <a href="httpd-tools-2.4.12-1.fc22.x86_64">httpd-tools-2.4.12-1.fc22.x86_64</a> 3/7
Installing : fedora-logos-<a href="httpd-22.0.0-1.fc22.noarch">httpd-22.0.0-1.fc22.noarch</a> 4/7
Installing : mailcap-2.1.44-1.fc22.noarch 5/7
Installing : <a href="httpd-filesystem-2.4.12-1.fc22.noarch">httpd-filesystem-2.4.12-1.fc22.noarch</a> 6/7
Installing : <a href="httpd-2.4.12-1.fc22.x86_64">httpd-2.4.12-1.fc22.x86_64</a> 7/7
Verifying : <a href="httpd-2.4.12-1.fc22.x86_64">httpd-2.4.12-1.fc22.x86_64</a> 1/7
Verifying : apr-1.5.1-3.fc22.x86_64 2/7
Verifying : apr-util-1.5.4-1.fc22.x86_64 3/7
Verifying : <a href="httpd-filesystem-2.4.12-1.fc22.noarch">httpd-filesystem-2.4.12-1.fc22.noarch</a> 4/7
Verifying : <a href="httpd-tools-2.4.12-1.fc22.x86_64">httpd-tools-2.4.12-1.fc22.x86_64</a> 5/7
Verifying : mailcap-2.1.44-1.fc22.noarch 6/7
Verifying : fedora-logos-<a href="httpd-22.0.0-1.fc22.noarch">httpd-22.0.0-1.fc22.noarch</a> 7/7</p>

<p>Installed:
apr.x86_64 1.5.1-3.fc22 apr-util.x86_64 1.5.4-1.fc22 fedora-logos-<a href="httpd.noarch">httpd.noarch</a> 22.0.0-1.fc22 <a href="httpd.x86_64">httpd.x86_64</a> 2.4.12-1.fc22
<a href="httpd-filesystem.noarch">httpd-filesystem.noarch</a> 2.4.12-1.fc22 <a href="httpd-tools.x86_64">httpd-tools.x86_64</a> 2.4.12-1.fc22 mailcap.noarch 2.1.44-1.fc22</p>

<p>Complete!
[root@f1c79aa4c931 /]#
[root@f1c79aa4c931 /]# exit
exit
[fedora@master ~]$
[/bash]
上面在一个互动的Bash里面完成了httpd的安装，exit命令之后，容器会停止运行，可以把这个停下来的镜像文件用下面的命令提交到本地的image库中。</p>

<p>[bash]
[fedora@master ~]$ sudo docker ps -a
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
f1c79aa4c931 fedora “bash” 17 minutes ago Exited (130) 3 minutes ago desperate_franklin
[fedora@master ~]$ sudo docker commit f1c79aa4c931 fedora-<a href="httpd">httpd</a>
c77c91fd4af681e736afc2ec76fc316732e25f52f6f3dd8aa97c973f28c55eb2
[fedora@master ~]$ sudo docker images
REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE
fedora-<a href="httpd">httpd</a> latest c77c91fd4af6 25 seconds ago 605.7 MB
docker.io/cockpit/ws latest 9a4331b694a6 3 weeks ago 572.2 MB
docker.io/fedora latest ded7cd95e059 7 weeks ago 186.5 MB
[/bash]</p>

<p>第一个名为 “fedora-httpd” 的就是刚才安装完毕之后，停止的docker image，用commit提交到本第的库中待用。下面开始准备网站的内容，其实只有一个主页，上只有一句话“HW”</p>

<p>[bash]
[fedora@master ~]$ pwd
/home/fedora
[fedora@master ~]$ vi index.html
[fedora@master ~]$ cat index.html
Hello World!
[fedora@master ~]$ tar -cf mysite.tar index.html
[fedora@a1 ~]$ ls
Dockerfile index.html mysite mysite.tar
[fedora@master ~]$ vi Dockerfile
[fedora@master ~]$ cat Dockerfile
FROM fedora-<a href="httpd">httpd</a>
MAINTAINER MartinLiu<a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#109;&#097;&#114;&#116;&#105;&#110;&#064;&#097;&#119;&#115;&#045;&#102;&#097;&#113;&#046;&#099;&#111;&#109;">&#109;&#097;&#114;&#116;&#105;&#110;&#064;&#097;&#119;&#115;&#045;&#102;&#097;&#113;&#046;&#099;&#111;&#109;</a></p>

<h1 id="add-the-tar-file-of-the-web-site">Add the tar file of the web site</h1>
<p>ADD mysite.tar /tmp/</p>

<h1 id="docker-automatically-extracted-so-move-files-to-web-directory">Docker automatically extracted. So move files to web directory</h1>
<p>RUN cp /tmp/index.html /var/www/html</p>

<p>EXPOSE 80</p>

<p>ENTRYPOINT [ “/usr/sbin/<a href="httpd">httpd”</a> ]
CMD [ “-D”, “FOREGROUND” ]
[/bash]</p>

<p>上面这段命令中最重要的是 Dockerfiler 文件，这个文件的语法还有很多，以上是一个最简化的例子。使用它可构建一个具有静态页面内容的网站。下面开始构建这个网站的Docker image。</p>

<p>[bash]
[fedora@a1 ~]$ sudo docker build -rm -t mysite .
Warning: ‘-rm’ is deprecated, it will be replaced by ‘–rm’ soon. See usage.
Sending build context to Docker daemon 31.74 kB
Sending build context to Docker daemon
Step 0 : FROM fedora-<a href="httpd">httpd</a>
—&gt; 05ce6f68d3f2
Step 1 : MAINTAINER A D Ministator email: martin@aws-faq.com
—&gt; Running in 7ee99e26ab76
—&gt; 03cc8c0deff1
Removing intermediate container 7ee99e26ab76
Step 2 : ADD mysite.tar /tmp/
—&gt; 52abfb1966ad
Removing intermediate container e6c20f7ca5ed
Step 3 : RUN mv /tmp/* /var/www/html
—&gt; Running in ef455353caff
—&gt; 6e24f9a9ea6f
Removing intermediate container ef455353caff
Step 4 : EXPOSE 80
—&gt; Running in 252b59576b54
—&gt; 7dd7c049c9d2
Removing intermediate container 252b59576b54
Step 5 : ENTRYPOINT /usr/sbin/<a href="httpd">httpd</a>
—&gt; Running in 572c3dafa53a
—&gt; fa01c160e081
Removing intermediate container 572c3dafa53a
Step 6 : CMD -D FOREGROUND
—&gt; Running in b133650a6e18
—&gt; f828e1847160
Removing intermediate container b133650a6e18
Successfully built f828e1847160</p>

<p>[fedora@master ~]$ sudo docker images
REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE
mysite latest 1bd6d7c1970f 45 seconds ago 605.7 MB
fedora-<a href="httpd">httpd</a> latest c77c91fd4af6 18 minutes ago 605.7 MB
docker.io/cockpit/ws latest 9a4331b694a6 3 weeks ago 572.2 MB
docker.io/fedora latest ded7cd95e059 7 weeks ago 186.5 MB</p>

<p>[fedora@master ~]$ sudo docker run -d -P mysite
6122ac7d4dff6cc73c4abc1523ac5dd02606c90d4e42da64823942d787694c1f
[fedora@master ~]$ sudo docker ps
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
6122ac7d4dff mysite “/usr/sbin/<a href="httpd">httpd</a> -D 37 seconds ago Up 35 seconds 0.0.0.0:32768-&gt;80/tcp evil_bardeen
e5032443ab69 cockpit/ws “/container/atomic-r 16 minutes ago Up 16 minutes stoic_sammet
[fedora@master ~]$ curl localhost:32768
Hello World!
[/bash]</p>

<p>在最后的命令行输出中，成功的看到了Hello World!的出现。用的是curl的命令行 web 浏览器。</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    
      
        <li><a href="/page4/" class="btn">向前</a></li>
      
    

    
    
      <li><a href="">1</a></li>
    

    
    
      
      
      <li>…</li>
    

    
    
    

    
      
        
        
        
        <li><a href="/page3/">3</a></li>
      
    
      
        
        
        
        <li><a href="/page4/">4</a></li>
      
    
      
        <li><strong class="current-page">5</strong></li>
      
    
      
        
        
        
        <li><a href="/page6/">6</a></li>
      
    
      
        
        
        
        <li><a href="/page7/">7</a></li>
      
    

    
    
      <li>…</li>
    

    
      <li><a href="/page93/">93</a></li>
    

    
    
      <li><a href="/page6/" class="btn">下一页</a></li>
    
  </ul>
</div>



</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2017 Martin Liu.</span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>



          

</body>
</html>